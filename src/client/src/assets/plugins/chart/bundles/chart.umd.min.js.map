{"version":3,"sources":["../../../../app/plugins/widgets/chart/src/edit/general/general.ts","../../../../app/plugins/widgets/chart/src/edit/general/general.html","../../../../app/plugins/widgets/chart/src/chart.m.ts","../../../../app/plugins/widgets/chart/src/edit/metrics/metrics.ts","../../../../app/plugins/widgets/chart/src/edit/metrics/metrics.html","../../../../app/plugins/widgets/chart/src/edit/axes/axes.ts","../../../../app/plugins/widgets/chart/src/edit/axes/axes.html","../../../../app/plugins/widgets/chart/src/edit/legend/legend.ts","../../../../app/plugins/widgets/chart/src/edit/editor.html","../../../../app/plugins/widgets/chart/src/edit/legend/legend.html","../../../../app/plugins/widgets/chart/src/edit/editor.ts","../../../../../node_modules/tslib/tslib.es6.js","../../../../app/plugins/widgets/chart/src/view/extensions/pixel-helper.ts","../../../../app/plugins/widgets/chart/src/view/extensions/trackball-drawer.ts","../../../../app/plugins/widgets/chart/src/view/render/color-helper.ts","../../../../app/plugins/widgets/chart/src/view/render/display-manager.ts","../../../../app/plugins/widgets/chart/src/view/data/data-converter.ts","../../../../app/plugins/widgets/chart/src/view/data/data-provider.ts","../../../../app/plugins/widgets/chart/src/view/axes/unit-helper.ts","../../../../app/plugins/widgets/chart/src/view/extensions/tooltip-builder.ts","../../../../app/plugins/widgets/chart/src/view/options-provider.ts","../../../../app/plugins/widgets/chart/src/base/chart.store.ts","../../../../app/plugins/widgets/chart/src/base/chart-base.ts","../../../../app/plugins/widgets/chart/src/view/legend/legend.html","../../../../app/plugins/widgets/chart/src/view/legend/legend.ts","../../../../app/plugins/widgets/chart/src/chart.html","../../../../app/plugins/widgets/chart/src/chart.c.ts","../../../../app/plugins/widgets/chart/src/chart.mod.ts"],"names":["GeneralEditorComponent","prototype","ngOnInit","console","log","ngOnDestroy","selectors","decls","vars","template","rf","ctx","i0.ɵɵtext","PANEL_TOKEN","MetricsEditorComponent","panel","this","i0","ɵɵdirectiveInject","AxesEditorComponent","LegendEditorComponent","Object","defineProperty","_b","_a","widget","legend","i0.ɵɵelement","consts","i0.ɵɵelementStart","i0.ɵɵelementEnd","i0.ɵɵlistener","i0.ɵɵadvance","i0.ɵɵproperty","ChartEditorComponent","router","activatedRoute","location","_this","index","queryParamMap","subscribe","params","p","get","Number","isInteger","onTabSelected","url","createUrlTree","relativeTo","queryParams","tab","queryParamsHandling","toString","go","i1","Router","ActivatedRoute","i2$1","Location","$event","i0.ɵɵtemplate","extendStatics","d","b","setPrototypeOf","__proto__","Array","hasOwnProperty","__extends","__","constructor","create","__read","o","n","m","Symbol","iterator","r","e","i","call","ar","next","done","push","value","error","__spread","arguments","length","concat","PixelHelper","alignPixel","chart","pixel","width","devicePixelRatio","currentDevicePixelRatio","halfWidth","Math","round","TrackballDrawerPlugin","ID","afterDatasetsDraw","easing","getMousePos","canvas","evt","rect","getBoundingClientRect","x","clientX","left","y","clientY","top","ColorHelper","getColor","ds","color","palette","hexToRgb","getColorAsArgbFunc","opacity","g","hex","result","exec","parseInt","parse","input","arr","substr","collen","fact","split","map","rgbToHex","c","padStart","DisplayManager","display","setup","setupLines","setupPoints","setupNullValue","showLines","getShowLines","lineWidth","getLineWidth","fill","getFill","backgroundColor","getLineColor","borderColor","borderWidth","steppedLine","getStaircase","getDashes","len","getDashLength","space","getDashSpace","borderDash","undefined","order","getZIndex","getLegend","showPoints","getShowPoints","pointBorderColor","pointBackgroundColor","pointRadius","getPointRadius","nullValue","setupOverrides","getOverride","lines","overrideColor","defaultColor","useOverride","lineFill","staircase","dashes","dashLength","dashSpace","points","zIndex","getYAxis","yAxis","overrides","find","alias","RegExp","test","label","ɵɵinject","factory","ɵfac","DataConverter","dispay","toDataSets","data","dataSets","totalIndex","forEach","serie","columns","slice","el","toDataSet","filter","values","isNull","Moment","valueOf","filteredValues","parseFloat","avg","reduce","a","allNulls","every","allZeros","generateDataSetName","lineTension","min","apply","max","current","root","name","tags","keyIndex","keys","key","AxisUnitType","DataProvider","pluginActivator","dsService","converter","time","data$","EventEmitter","timeSubs","range$","pipe","tap","_","request","mergeMap","createDataSourceMetricsBuilder","mb","build","metrics","range","pull","destroy","unsubscribe","loading","proxy","finalize","onData","onError","emit","datasets","err","i1$1","PluginActivator","DataSourceService","TimeRangeStore","AxisUnit","type","unit","command","AxisUnitHelper","getData","Common_Short","Common_Percent","Common_Percent01","Common_Humidity","Common_Decibel","Common_Hex0x","Common_Hex","Common_SciNotation","Common_LocaleString","Length_Millimetre","Length_Meter","Length_Feet","Length_Kilometer","Length_Mile","Area_SquareMeters","Area_SquareFeet","Area_SquareMiles","Mass_Milligram","Mass_Gram","Mass_Kilogram","Mass_MetricTon","None","getFormattedValue","decimals","toFixed","unitData","toExponential","toLocaleString","getShortFormattedValue","dev","u","TooltipBuilder","comp","Chart","Tooltip","positioners","custom","elements","eventPosition","mode","position","axis","intersect","caretSize","xPadding","bodySpacing","titleAlign","enabled","model","createCustomElement","tooltipModel","tooltipEl","getRootElement","classList","remove","yAlign","add","body","createBody","setPosition","style","control","elWidth","document","getElementsByClassName","TOOLTIP_SELECTOR","negMargin","caretX","window","pageXOffset","pageYOffset","caretY","fontFamily","_bodyFontFamily","padding","yPadding","pointerEvents","titleLines","title","innerHtml","date","Date","format","classGraphTime","sort","seriesName","colorFunc","seriesNameEl","classSeriesName","w","store","yAxisID","axes","leftY","rightY","resValue","valueEl","classSeriesValue","querySelector","innerHTML","bodyLines","bodyItem","parsedBodyLines","colors","labelColors","lastIndexOf","substring","dataPoints","getElementById","createElement","id","classGraphTooltip","classGraphanaTooltip","appendChild","OptionsProvider","getOptions","defaults","global","defaultFontColor","defaultFontFamily","defaultFontSize","axisYa","gridLines","zeroLineWidth","maintainAspectRatio","animation","tooltips","spanGaps","scales","xAxes","ticks","autoSkip","autoSkipPadding","maxRotation","minRotation","displayFormats","second","minute","hour","day","week","month","year","yAxes","ChartStore","dataProvider","BehaviorSubject","widget$","asObservable","control_","control$","ctrl","BaseChartComponent","dataSubs","widgetSubs","onWidgetReady","ctrlSubs","onControlReady","_c","i0.ɵɵtextInterpolate","i0.ɵɵstyleProp","ChartLegendComponent","_super","onSeriesClicked","ctrlKey","selected","toggleSeries","selected_1","refresh","hidden","features","ɵɵInheritDefinitionFeature","_r1","FadeInOutAnimation","ChartComponent","plugins","options","ngAfterViewInit","ctrlChart","viewQuery","UIChart","ChartWidgetModule","imports","CommonModule","FormsModule","ReactiveFormsModule","ChartModule","EdCommonModule","EdUilibModule","PerfectScrollbarModule","declarations","exports"],"mappings":"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","sourcesContent":["import { Component } from '@angular/core';\n\n@Component({\n  selector: 'editor-general',\n  templateUrl: './general.html'\n})\nexport class GeneralEditorComponent {\n \n  ngOnInit(){\n    console.log( 'create GeneralEditorComponent' )\n  }\n\n  ngOnDestroy(){\n    console.log( 'detroy GeneralEditorComponent' )\n  }\n}\n","general will be here","export const PANEL_TOKEN = \"panel\";\r\n\r\nexport interface ChartData{\r\n\tdatasets: DataSet[];\r\n}\r\n\r\nexport interface DataSet{\r\n\tlabel: string;\r\n\tdata: DataPoint[];\r\n\r\n\tmin?: number;\r\n\tmax?: number\r\n\tavg?: number;\r\n\tcurrent?: number;\r\n\r\n\tallNulls?: boolean;\r\n\tallZeros?: boolean;\r\n\r\n\tindex: number;\r\n\r\n\t//display\r\n\tfill?: boolean;\r\n\tbackgroundColor?:string; \r\n\tborderColor?: string;\r\n\tborderWidth?: number;\r\n\r\n\tpointBorderColor?: string; \r\n\tpointBackgroundColor?: string; \r\n\tpointRadius?: number; \r\n\r\n\tsteppedLine?: boolean;\r\n\r\n\tborderDash?: number[]\r\n\r\n\torder?: number;\r\n\r\n\tlegend?: boolean;\r\n\thidden?: boolean;\r\n\tselected?: boolean;\r\n}\r\n\r\nexport interface DataPoint{\r\n\tx?: number;\r\n\ty?: number;\r\n\tisNull: boolean;\r\n}\r\n\r\nexport interface RGB{\r\n\tr: number;\r\n\tg: number;\r\n\tb: number;\r\n}\r\n\r\nexport interface Chart{\r\n\tlegend: Legend;\r\n}\r\n\r\nexport interface Legend{\r\n\tshow: boolean;\r\n\ttable: boolean;\r\n\tright: boolean;\r\n\r\n\tmin: number;\r\n\tmax: number;\r\n\tavg: number;\r\n\tcurrent: number;\r\n\ttotal: number;\r\n\tdecimals? : number;\r\n}","import { Component, Inject } from '@angular/core';\nimport { Panel } from 'common';\nimport { PANEL_TOKEN } from '../../chart.m';\n\n\n@Component({\n  selector: 'editor-metrics',\n  templateUrl: './metrics.html'\n})\nexport class MetricsEditorComponent {\n \n  constructor(@Inject( PANEL_TOKEN ) private panel: Panel){\n    \n  }\n  ngOnInit(){\n    console.log( 'create MetricsComponent' )\n    console.log( this.panel );\n  }\n\n  ngOnDestroy(){\n    console.log( 'detroy MetricsComponent' )\n  }\n}\n","metrics will be here","import { Component } from '@angular/core';\n\n\n@Component({\n  selector: 'editor-axes',\n  templateUrl: './axes.html'\n})\nexport class AxesEditorComponent {\n \n  ngOnInit(){\n    console.log( 'create AxesEditorComponent' )\n  }\n\n  ngOnDestroy(){\n    console.log( 'detroy AxesEditorComponent' )\n  }\n}\n","axes will be here","import { Component, Inject } from '@angular/core';\nimport { Panel } from 'common';\nimport { PANEL_TOKEN } from '../../chart.m';\n\n@Component({\n  selector: 'editor-legend',\n  templateUrl: './legend.html'\n})\nexport class LegendEditorComponent {\n \n  get legend(){\n    return this.panel?.widget?.legend;\n  }\n  \n  constructor(@Inject( PANEL_TOKEN ) private panel: Panel){\n  }\n}\n","<ed-tabstrip header=\"Graph\"\r\n\t[(ngModel)]=\"index\"\r\n\t(selected)=\"onTabSelected($event)\">\r\n\r\n\t<ed-tab header=\"General\">\r\n\t\t<ng-template edTabContent>\r\n\t\t\t<editor-general></editor-general>\r\n\t\t</ng-template>\r\n\t</ed-tab>\r\n\r\n\t<ed-tab header=\"Metrics\">\r\n\t\t<ng-template edTabContent>\r\n\t\t\t<editor-metrics></editor-metrics>\r\n\t\t</ng-template>\r\n\t</ed-tab>\r\n\r\n\t<ed-tab header=\"Axes\">\r\n\t\t<ng-template edTabContent>\r\n\t\t\t<editor-axes></editor-axes>\r\n\t\t</ng-template>\r\n\t</ed-tab>\r\n\r\n\t<ed-tab header=\"Legend\">\r\n\t\t<ng-template edTabContent>\r\n\t\t\t<editor-legend></editor-legend>\r\n\t\t</ng-template>\r\n\t</ed-tab>\r\n\r\n\t<ed-tab header=\"Display\">\r\n\t\t<ng-template edTabContent>\r\n\t\t\tdisplay will be here\r\n\t\t</ng-template>\r\n\t</ed-tab>\r\n\r\n\t<ed-tab header=\"Alert\">\r\n\t\t<ng-template edTabContent>\r\n\t\t\talert will be here\r\n\t\t</ng-template>\r\n\t</ed-tab>\r\n\r\n\t<ed-tab header=\"Time range\">\r\n\t\t<ng-template edTabContent>\r\n\t\t\ttime range will be here\r\n\t\t</ng-template>\r\n\t</ed-tab>\r\n\r\n</ed-tabstrip>\r\n","<div class=\"section gf-form-group\">\r\n\t<h5 class=\"section-heading\">Options</h5>\r\n\r\n\t<ed-checkbox \r\n\t\tlabelWidth=\"7\"\r\n\t\tlabel=\"Show\"\r\n\t\t[(ngModel)]=\"legend.show\">\r\n\t</ed-checkbox>\r\n\r\n\t<ed-checkbox \r\n\t\tlabelWidth=\"7\"\r\n\t\tlabel=\"As Table\"\r\n\t\t[(ngModel)]=\"legend.table\">\r\n\t</ed-checkbox>\r\n\r\n\t<ed-checkbox \r\n\t\tlabelWidth=\"7\"\r\n\t\tlabel=\"To the right\"\r\n\t\t[(ngModel)]=\"legend.right\">\r\n\t</ed-checkbox>\r\n</div>\r\n\r\n<div class=\"section gf-form-group\">\r\n\t<h5 class=\"section-heading\">Values</h5>\r\n\r\n\t<div class=\"gf-form-inline\">\r\n\t\t<ed-checkbox \r\n\t\t\tlabelWidth=\"4\"\r\n\t\t\tlabel=\"Min\"\r\n\t\t\t[(ngModel)]=\"legend.min\">\r\n\t\t</ed-checkbox>\r\n\r\n\t\t<ed-checkbox \r\n\t\t\tlabelWidth=\"6\"\r\n\t\t\tlabel=\"Min\"\r\n\t\t\t[(ngModel)]=\"legend.max\">\r\n\t\t</ed-checkbox>\r\n\t</div>\r\n\r\n\t<div class=\"gf-form-inline\">\r\n\t\t<ed-checkbox \r\n\t\t\tlabelWidth=\"4\"\r\n\t\t\tlabel=\"Avg\"\r\n\t\t\t[(ngModel)]=\"legend.avg\">\r\n\t\t</ed-checkbox>\r\n\r\n\t\t<ed-checkbox \r\n\t\t\tlabelWidth=\"6\"\r\n\t\t\tlabel=\"Current\"\r\n\t\t\t[(ngModel)]=\"legend.current\">\r\n\t\t</ed-checkbox>\r\n\t</div>\r\n\r\n\t<div class=\"gf-form-inline\">\r\n\t\t<ed-checkbox \r\n\t\t\tlabelWidth=\"4\"\r\n\t\t\tlabel=\"Total\"\r\n\t\t\t[(ngModel)]=\"legend.total\">\r\n\t\t</ed-checkbox>\r\n\r\n\t\t<!-- <ed-checkbox \r\n\t\t\tlabelWidth=\"6\"\r\n\t\t\tlabel=\"Current\"\r\n\t\t\t[(ngModel)]=\"legend.current\">\r\n\t\t</ed-checkbox> -->\r\n\t</div>\r\n\r\n</div>\r\n\r\n<div class=\"section gf-form-group\">\r\n\t<h5 class=\"section-heading\">Hide series</h5>\r\n\r\n\t<ed-checkbox \r\n\t\tlabelWidth=\"10\"\r\n\t\tlabel=\"With only nulls\"\r\n\t\t[(ngModel)]=\"legend.hideOnlyNulls\">\r\n\t</ed-checkbox>\r\n\r\n\t<ed-checkbox \r\n\t\tlabelWidth=\"10\"\r\n\t\tlabel=\"With only zeros\"\r\n\t\t[(ngModel)]=\"legend.hideOnlyZeroes\">\r\n\t</ed-checkbox>\r\n\r\n</div>","import { Location } from '@angular/common';\nimport { Component } from '@angular/core';\nimport { ActivatedRoute, Router } from '@angular/router';\n\n@Component({\n  selector: 'widget-editor',\n  templateUrl: './editor.html'\n})\nexport class ChartEditorComponent {\n  index: number = 0;\n\n  constructor(\n    private router: Router,\n    private activatedRoute: ActivatedRoute,\n    private location: Location){\n      this\n        .activatedRoute\n        .queryParamMap\n        .subscribe((params) => {\n          const p = params.get( 'tab' );\n\n          if( Number.isInteger( +p )){\n            this.index = +p;\n          } \n        });\n  }\n\n  onTabSelected( index: number ){\n    const url = this\n      .router\n      .createUrlTree([], {\n        relativeTo: this.activatedRoute,\n        queryParams: {tab: index},\n        queryParamsHandling: 'merge',\n      })\n      .toString()\n\n    this.location.go(url);\n  }\n}\n","/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport function __createBinding(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n}\r\n\r\nexport function __exportStar(m, exports) {\r\n    for (var p in m) if (p !== \"default\" && !exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\r\n    result.default = mod;\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, privateMap) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to get private field on non-instance\");\r\n    }\r\n    return privateMap.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, privateMap, value) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to set private field on non-instance\");\r\n    }\r\n    privateMap.set(receiver, value);\r\n    return value;\r\n}\r\n","\r\nexport class PixelHelper {\r\n\tpublic static alignPixel( chart, pixel, width) {\r\n\t\tvar devicePixelRatio = chart.currentDevicePixelRatio;\r\n\t\tvar halfWidth = width / 2;\r\n\t\treturn Math.round((pixel - halfWidth) * devicePixelRatio) / devicePixelRatio + halfWidth;\r\n\t};\r\n}\r\n","import { PixelHelper } from \"./pixel-helper\";\r\n\r\nexport class TrackballDrawerPlugin {\r\n\tstatic readonly ID = \"trackball\";\r\n\r\n\tget id(){\r\n\t\treturn TrackballDrawerPlugin.ID;\r\n\t}\r\n\r\n\tafterDatasetsDraw(chart, easing) {\r\n\t\t//console.log( \"trackball plugin\" )\r\n\t\treturn;\r\n\t\t\r\n\t\tconst context = chart.chart.ctx;\r\n\r\n\t\tconst scaleX = chart.scales['x-axis-0'];\r\n\t\t\r\n\t\t//const scaleYA = chart.scales[ \"A\" ];\r\n\t\tconst scaleYA = chart.scales[ \"y-axis-0\" ];\r\n\r\n\t\tvar pos = this.getMousePos( chart.canvas, chart.trackball );\r\n\r\n\t\tconsole.log( pos );\r\n\r\n\t\tconst shouldIgnore = \r\n\t\t\t( !chart.trackball ) ||\r\n\t\t\t( 0 == chart.data.datasets.length ) ||\r\n\t\t\t( pos.x < scaleX.left || pos.x > scaleX.right );\r\n\r\n\t\tif( shouldIgnore ){\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst lw = 0.8;\r\n\t\tconst x = PixelHelper.alignPixel( chart, pos.x, lw )\r\n\t\tconst y1 = PixelHelper.alignPixel( chart, scaleYA.top, lw )\r\n\t\tconst y2 = PixelHelper.alignPixel( chart, scaleYA.bottom, lw )\r\n\r\n\t\tcontext.beginPath();\r\n\t\tcontext.strokeStyle = \"#880015\";\r\n\t\tcontext.lineWidth = lw;\r\n\t\tcontext.moveTo( x, y1 );\r\n\t\tcontext.lineTo( x, y2);\r\n\t\tcontext.stroke();\r\n\t}\r\n\r\n\tgetMousePos(canvas, evt) {\r\n\t\tif( !evt ){\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n    var rect = canvas.getBoundingClientRect();\r\n    return {\r\n      x: evt.clientX - rect.left,\r\n      y: evt.clientY - rect.top\r\n    };\r\n\t}\r\n\r\n}","import { DataSet, RGB } from '../../chart.m';\r\n\r\nexport class ColorHelper {\r\n\r\n\tprivate static palette = [\r\n\t\t\t\r\n\t\t\"7eb26d\",\r\n\t\t\"cca300\",\r\n\t\t\"6ed0e0\",\r\n\t\t\"EF843C\",\r\n\t\t\"E24D42\",\r\n\t\t\"1F78C1\",\r\n\t\t\"BA43A9\",\r\n\t\t\"705DA0\",\r\n\t\t\"508642\",\r\n\t\t\"CCA300\",\r\n\t\t\"447EBC\",\r\n\t\t\"C15C17\",\r\n\t\t\"890F02\",\r\n\t\t\"0A437C\",\r\n\t\t\"6D1F62\",\r\n\t\t\"584477\",\r\n\t\t\"B7DBAB\",\r\n\t\t\"F4D598\",\r\n\t\t\"70DBED\",\r\n\t\t\"F9BA8F\",\r\n\t\t\"F29191\",\r\n\t\t\"82B5D8\",\r\n\t\t\"E5A8E2\",\r\n\t\t\"AEA2E0\",\r\n\t\t\"629E51\",\r\n\t\t\"E5AC0E\",\r\n\t\t\"64B0C8\",\r\n\t\t\"E0752D\",\r\n\t\t\"BF1B00\",\r\n\t\t\"0A50A1\",\r\n\t\t\"962D82\",\r\n\t\t\"614D93\",\r\n\t\t\"9AC48A\",\r\n\t\t\"F2C96D\",\r\n\t\t\"65C5DB\",\r\n\t\t\"F9934E\",\r\n\t\t\"5195CE\",\r\n\t\t\"D683CE\",\r\n\t\t\"806EB7\",\r\n\t\t\"3F6833\",\r\n\t\t\"967302\",\r\n\t\t\"2F575E\",\r\n\t\t\"99440A\",\r\n\t\t\"58140C\",\r\n\t\t\"052B51\",\r\n\t\t\"511749\",\r\n\t\t\"3F2B5B\",\r\n\t\t\"E0F9D7\",\r\n\t\t\"FCEACA\",\r\n\t\t\"CFFAFF\",\r\n\t\t\"F9E2D2\",\r\n\t\t\"FCE2DE\",\r\n\t\t\"BADFF4\",\r\n\t\t\"F9D9F9\",\r\n\t\t\"DEDAF7\",\r\n\t\t\"EA6460\"\r\n\t]\r\n\r\n\tstatic getColor(ds: DataSet) {\r\n\t\tconst color = this.palette[ds.index % this.palette.length];\r\n\r\n\t\treturn this.hexToRgb(color);\r\n\t}\r\n\r\n\tstatic getColorAsArgbFunc(ds: DataSet, opacity: number = 1) {\r\n\t\tconst color = this.getColor(ds);\r\n\r\n\t\treturn `rgba(${color.r},${color.g},${color.b}, ${opacity})`\r\n\t}\r\n\r\n\tprivate static hexToRgb(hex: string) {\r\n\t\tvar result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);\r\n\t\treturn result ? {\r\n\t\t\tr: parseInt(result[1], 16),\r\n\t\t\tg: parseInt(result[2], 16),\r\n\t\t\tb: parseInt(result[3], 16)\r\n\t\t} : null;\r\n\t}\r\n\r\n\tstatic parse(input: any): RGB {\r\n\t\tvar arr = [];\r\n\r\n\t\tif (input.substr(0,1)==\"#\") {\r\n\t\t\tvar collen=(input.length-1)/3;\r\n\t\t\tvar fact=[17,1,0.062272][collen-1];\r\n\t\t\tarr = [\r\n\t\t\t\t\tMath.round(parseInt(input.substr(1,collen),16)*fact),\r\n\t\t\t\t\tMath.round(parseInt(input.substr(1+collen,collen),16)*fact),\r\n\t\t\t\t\tMath.round(parseInt(input.substr(1+2*collen,collen),16)*fact)\r\n\t\t\t];\r\n\t\t}\r\n\t\telse {\r\n\t\t\tarr =  input.split(\"(\")[1].split(\")\")[0].split(\",\").map(Math.round);\r\n\t\t} \r\n\r\n\t\treturn {\r\n\t\t\tr: arr[ 0 ],\r\n\t\t\tg: arr[ 1 ],\r\n\t\t\tb: arr[ 2 ]\r\n\t\t}\r\n\t\t\t\r\n\t}\r\n\r\n\tstatic rgbToHex( e:string ) : string{\r\n\t\tconst c = ColorHelper.parse( e )\r\n\t\tconst r = c.r.toString(16).padStart(2, \"0\");\r\n\t\tconst g = c.g.toString(16).padStart(2, \"0\");\r\n\t\tconst b = c.b.toString(16).padStart(2, \"0\");\r\n\r\n\t\treturn `#${r}${g}${b}`;\r\n\t}\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","import { Inject, Injectable } from '@angular/core';\r\nimport { Panel } from 'common';\r\nimport { DataSet, PANEL_TOKEN } from '../../chart.m';\r\nimport { ColorHelper } from './color-helper';\r\n\r\n@Injectable()\r\nexport class DisplayManager {\r\n\r\n\tprivate get display() {\r\n\t\treturn this.panel.widget.display;\r\n\t}\r\n\r\n\tconstructor ( @Inject( PANEL_TOKEN ) private panel: Panel ) {\r\n\r\n\t}\r\n\r\n\tsetup(ds: DataSet) {\r\n\t\t//this.setupSecondaryYAxis();\t\t\t\t\t\r\n\r\n\t\tthis.setupLines( ds );\r\n\t\tthis.setupPoints( ds );\r\n\t\tthis.setupNullValue( ds );\r\n\r\n\t\t//this.chart.options.scales.yAxes[ 0 ].stacked = this.chart.widget.display.stack;\r\n\t}\r\n\r\n\tprivate setupLines( ds: DataSet ) {\r\n\t\tconst showLines = this.getShowLines( ds );\r\n\t\tconst lineWidth = this.getLineWidth( ds );\r\n\t\tconst fill = this.getFill( ds );\r\n\r\n\t\tlet opacity = ( fill / 10);\r\n\t\tds.fill = (/*showLines &&*/ fill > 0);\r\n\t\tds.backgroundColor = this.getLineColor( ds, opacity );\r\n\r\n\t\topacity = (showLines && lineWidth) ? 1 : 0;\r\n\t\tds.borderColor = this.getLineColor( ds, opacity );\r\n\t\tds.borderWidth = lineWidth;\r\n\r\n\t\t ds.steppedLine = this.getStaircase( ds );\r\n\r\n\t\tif( this.getDashes( ds ) ){\r\n\t\t\tconst len = this.getDashLength( ds );\r\n\t\t\tconst space = this.getDashSpace( ds );\r\n\t\t\tds.borderDash = [ len, space ]\r\n\t\t}\r\n\t\telse{\r\n\t\t\tds.borderDash = undefined;\r\n\t\t}\r\n\r\n\t\tds.order = this.getZIndex( ds );\r\n\t\tds.legend = this.getLegend( ds );\r\n\r\n\t\t// ds.yAxisID = ( 1 == this.getYAxis( ds ) ) ? 'A': 'B';\r\n\t}\r\n\r\n\tprivate setupPoints( ds: DataSet ) {\r\n\t\tconst showPoints = this.getShowPoints( ds );\r\n\r\n\t\tconst opacity = showPoints ? 1 : 0\r\n\t\tconst color = this.getLineColor( ds, opacity );\r\n\r\n\t\tds.pointBorderColor = `${color}`;\r\n\t\tds.pointBackgroundColor = `${color}`;\r\n\r\n\t\tds.pointRadius = showPoints ? this.getPointRadius( ds ) : 0;\r\n\t}\r\n\r\n\tprivate setupNullValue( ds: DataSet ) {\r\n\t\tswitch (parseInt( this.display.nullValue )) {\r\n\t\t\t// case CartesianChart.NullValue.Connected:\r\n\t\t\t// \tthis.chart.options.spanGaps = true;\r\n\t\t\t// \tds.data.forEach( p => p.y = p.isNull ? null : p.y );\r\n\t\t\t// \tbreak;\r\n\r\n\t\t\t// case CartesianChart.NullValue.Null:\r\n\t\t\t// \tthis.chart.options.spanGaps = false;\r\n\t\t\t// \tds.data.forEach( p => p.y = p.isNull ? null : p.y );\r\n\t\t\t// \tbreak;\r\n\r\n\t\t\t// case CartesianChart.NullValue.NullAsZero:\r\n\t\t\t// \tthis.chart.options.spanGaps = false;\r\n\t\t\t// \tds.data.forEach( p => p.y = p.isNull ? 0 : p.y );\r\n\t\t\t// \tbreak;\r\n\t\t}\r\n\t}\r\n\r\n\tprivate setupOverrides(){\r\n\t\t// const needSecondaryYAxis = AxesManager.needSecondaryYAxis( this.chart.widget );\r\n\r\n\t\t// const actualSecondaryYAxisUsers = this\r\n\t\t// \t.datasets\r\n\t\t// \t.filter( x => x.yAxisID == 'B' )\r\n\t\t// \t.length\r\n \r\n\t\t// const yAxesCount = this.chart.options.scales.yAxes.length;\r\n\t\t\r\n\t\t// if( 2 == yAxesCount && !needSecondaryYAxis ){\r\n\t\t// \tthis.chart.options.scales.yAxes.splice( 1, 1 );\r\n\t\t// } else if( /*1 == yAxesCount && needSecondaryYAxis*/ actualSecondaryYAxisUsers != needSecondaryYAxis ){\r\n\t\t// \tthis.chart.destroy();\r\n\t\t// \tthis.chart.needRebuild.emit();\r\n\t\t// \tthis.chart = undefined;\r\n\t\t// \treturn;\r\n\t\t// }\r\n\r\n\t\t// this.datasets.forEach(x => this.setup(x));\r\n\t}\r\n\r\n\tgetShowLines(ds: DataSet): boolean{\r\n\t\tconst o = this.getOverride( ds );\r\n\r\n\t\treturn ( o && undefined != o.lines ) ? o.lines : this.display.showLines;\r\n\t}\r\n\t\r\n\tgetLineWidth(ds: DataSet): number{\r\n\t\tconst o = this.getOverride( ds );\r\n\r\n\t\treturn ( o && undefined != o.lineWidth ) ? o.lineWidth : this.display.lineWidth;\r\n\t}\r\n\r\n\tgetLineColor(ds: DataSet, opacity: number) : string{\r\n\t\tconst o = this.getOverride( ds );\r\n\r\n\t\tconst defaultColor = ColorHelper.getColorAsArgbFunc(ds, opacity)\r\n\r\n\t\tconst useOverride = ( o && undefined != o.color )\r\n\t\tlet overrideColor: string;\r\n\r\n\t\tif( useOverride ){\r\n\t\t\tvar color = ColorHelper.parse( o.color );\r\n\t\t\toverrideColor = `rgba(${color.r},${color.g},${color.b},${opacity})`\r\n\t\t}\r\n\r\n\t\treturn ( useOverride ) ? overrideColor : defaultColor;\r\n\t}\r\n\r\n\tgetFill( ds: DataSet ): number{\r\n\t\tconst o = this.getOverride( ds );\r\n\r\n\t\treturn ( o && undefined != o.lineFill ) ? o.lineFill : this.display.fill;\r\n\t}\r\n\r\n\tgetStaircase( ds: DataSet ): boolean{\r\n\t\tconst o = this.getOverride( ds );\r\n\r\n\t\treturn ( o && undefined != o.staircase ) ? o.staircase : this.display.staircase;\r\n\t}\r\n\r\n\tgetDashes( ds: DataSet ){\r\n\t\tconst o = this.getOverride( ds );\r\n\r\n\t\treturn ( o && undefined != o.dashes ) ? o.dashes : false;\r\n\t}\r\n\r\n\tgetDashLength( ds: DataSet ): number{\r\n\t\tconst o = this.getOverride( ds );\r\n\r\n\t\treturn ( o && undefined != o.dashLength ) ? o.dashLength : 1;\r\n\t}\r\n\r\n\tgetDashSpace( ds: DataSet ): number{\r\n\t\tconst o = this.getOverride( ds );\r\n\r\n\t\treturn ( o && undefined != o.dashSpace ) ? o.dashSpace : 1;\r\n\t}\r\n\r\n\tgetShowPoints( ds: DataSet ) : boolean {\r\n\t\tconst o = this.getOverride( ds );\r\n\r\n\t\treturn ( o && undefined != o.points ) ? o.points : this.display.showPoints;\r\n\t}\r\n\r\n\tgetPointRadius( ds: DataSet ) : number{\r\n\t\tconst o = this.getOverride( ds );\r\n\r\n\t\treturn ( o && undefined != o.pointRadius ) ? o.pointRadius : this.display.pointRadius;\r\n\t}\r\n\r\n\tgetLegend( ds: DataSet ) : boolean{\r\n\t\tconst o = this.getOverride( ds );\r\n\r\n\t\treturn ( o && undefined != o.legend ) ? o.legend : true;\r\n\t}\r\n\r\n\tgetZIndex( ds: DataSet ): number{\r\n\t\tconst o = this.getOverride( ds );\r\n\r\n\t\treturn ( o && undefined != o.zIndex ) ? o.zIndex : 0;\r\n\t}\r\n\r\n\tgetYAxis( ds: DataSet ){\r\n\t\tconst o = this.getOverride( ds );\r\n\r\n\t\treturn ( o && undefined != o.yAxis ) ? o.yAxis : 1;\r\n\t}\r\n\r\n\tgetOverride( ds: DataSet ){\r\n\t\treturn this\r\n\t\t\t.display\r\n\t\t\t.overrides\r\n\t\t\t.find( x => x.alias && new RegExp( x.alias ).test( ds.label )  )\r\n\t}\r\n\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","import { Injectable } from '@angular/core';\r\nimport { Moment, Series } from 'common';\r\nimport { DataSet } from '../../chart.m';\r\nimport { DisplayManager } from '../render/display-manager';\r\n\r\n@Injectable()\r\nexport class DataConverter {\r\n\r\n\tconstructor( private dispay: DisplayManager ){\r\n\t\t\r\n\t}\r\n\t\r\n\ttoDataSets(data: Series[]) : DataSet[] {\r\n\t\tif (!data || 0 === data.length) {\r\n\t\t\treturn [];\r\n\t\t}\r\n\r\n\t\tlet dataSets = [];\r\n\t\tlet totalIndex = 0;\r\n\r\n\t\tdata.forEach(serie => {\r\n\t\t\tconst columns = serie.columns.slice(1);\r\n\r\n\t\t\tconst arr = [...columns.map((el, index) =>\r\n\t\t\t\tthis.toDataSet(serie, index + 1, totalIndex++))]\r\n\t\t\t\t.filter(x => x);\r\n\r\n\t\t\tdataSets = [...dataSets, ...arr];\r\n\r\n\t\t\tdataSets.forEach( x => this.dispay.setup( x ) )\r\n\t\t});\r\n\r\n\t\t\r\n\t\t//this.chart.widget.error = undefined;\r\n\t\treturn dataSets;\r\n\t}\r\n\r\n\tprivate toDataSet(serie: Series, index: number, totalIndex:number) : DataSet {\r\n\t\tconst values = serie\r\n\t\t\t.values\r\n\t\t\t.map(x => {\r\n\t\t\t\tconst isNull = (null == x[index]);\r\n\r\n\t\t\t\treturn {\r\n\t\t\t\t\tx: Moment.valueOf( x[0] ),\r\n\t\t\t\t\ty: (isNull) ? x[index] : x[index],\r\n\t\t\t\t\tisNull: isNull\r\n\t\t\t\t}\r\n\t\t\t})\r\n\r\n\t\tconst filteredValues = values\r\n\t\t\t.map(p => p.y)\r\n\t\t\t.filter(p => null != p)\r\n\t\t\t.map(p => parseFloat(p));\r\n\r\n\t\tif (0 == filteredValues.length) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst avg = (filteredValues.reduce((a, b) => a + b) / filteredValues.length)\r\n\r\n\t\tconst allNulls = filteredValues.every(x => x == null);\r\n\t\tconst allZeros = filteredValues.every(x => x == 0);\r\n\r\n\t\tconst ds = {\r\n\t\t\tlabel: this.generateDataSetName(serie, index),\r\n\t\t\tdata: values,\r\n\t\t\tlineTension: 0,\r\n\t\t\tmin: Math.min(...filteredValues),\r\n\t\t\tmax: Math.max(...filteredValues),\r\n\t\t\tavg: avg,\r\n\t\t\tcurrent: filteredValues.slice(-1)[0],\r\n\t\t\tallNulls: allNulls,\r\n\t\t\tallZeros: allZeros,\r\n\t\t\tindex: totalIndex,\r\n\t\t\tpointRadius:0,\r\n\t\t\tborderColor: \"#ff0000\"\r\n\t\t\t//widget: this.chart.widget,\r\n\t\t}\r\n\r\n\t\t//ds.borderColor = new ColorHelper().getColorAsArgbFunc( ds, 1 );\r\n\t\t//console.log( ds.borderColor );\r\n\r\n\t\t//this.display.setup(ds);\r\n\r\n\t\treturn ds;\r\n\t}\r\n\r\n\tprivate generateDataSetName( serie: Series, index: number ): string{\r\n\t\tlet root = `${serie.name}.${serie.columns[ index ]}`;\r\n\r\n\t\tlet tags = '';\r\n\t\tvar keys = Object.keys(serie.tags);\r\n\t\tvar keyIndex = 0;\r\n\r\n\t\tfor(var key in serie.tags){\r\n\t\t\ttags += `${keyIndex > 0 ? ', ': ''}${key}: ${serie.tags[ key ]}` ;\r\n\t\t\tkeyIndex++\r\n\t\t}\r\n\r\n\t\t// serie.tags.forEach( ( t, index ) => tags = `${tags}${index > 0 ? ',': ''} tag` )\r\n\r\n\t\tif( tags ){\r\n\t\t\troot = `${root} {${tags}}`;\r\n\t\t}\r\n\r\n\t\treturn root;\r\n\t}\r\n}","import { EventEmitter, Inject, Injectable, Injector } from \"@angular/core\";\r\nimport { Subscription } from \"rxjs\";\r\nimport { finalize, mergeMap, tap } from 'rxjs/operators';\r\nimport { Panel, TimeRangeStore, PluginLoader, PluginStore,\r\n\tDataSourceService, Plugin, PluginActivator, MetricsBuilder } from 'common';\r\nimport { DataConverter } from './data-converter';\r\nimport { ChartData, PANEL_TOKEN } from '../../chart.m';\r\n\r\n@Injectable()\r\nexport class DataProvider {\r\n\trequest: string;\r\n\ttimeSubs: Subscription;\r\n\r\n\tdata$ = new EventEmitter<ChartData>();\r\n\r\n\tget metrics(){\r\n\t\treturn this.panel?.widget?.metrics;\r\n\t}\r\n\r\n\tconstructor (\r\n\t\tprivate pluginActivator: PluginActivator,\r\n\t\tprivate dsService: DataSourceService,\r\n\t\tprivate converter: DataConverter,\r\n\t\tprivate time: TimeRangeStore,\r\n\t\t@Inject( PANEL_TOKEN ) private panel: Panel ) {\r\n\r\n\t\t\tthis.timeSubs = this\r\n\t\t\t\t.time\r\n\t\t\t\t.range$\r\n\t\t\t\t.pipe(\r\n\t\t\t\t\ttap( _ => this.request = '' ),\r\n\t\t\t\t\tmergeMap( _ => this.pluginActivator.createDataSourceMetricsBuilder( panel ) ),\r\n\t\t\t\t\tmergeMap( mb=> mb.build( this.metrics, time.range )))\r\n\t\t\t\t.subscribe( x => this.pull( <string>x ));\r\n\t}\r\n\r\n\tdestroy(){\r\n\t\tthis.timeSubs?.unsubscribe();\r\n\t}\r\n\r\n\tprivate pull( request: string){\r\n\t\tif (this.request === request) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis.request = request;\r\n\r\n\t\tconsole.log( `pull: ${request}` );\r\n\t\t\r\n\t\tif (!request) {\r\n\t\t\tthis.onData([])\r\n\t\t} else {\r\n\t\t\tthis.panel.loading = true;\r\n\r\n\t\t\tthis\r\n\t\t\t\t.dsService\r\n\t\t\t\t.proxy( 6, request)\r\n\t\t\t\t.pipe(\r\n\t\t\t\t\tfinalize(() => this.panel.loading = false ))\r\n\t\t\t\t.subscribe(\r\n\t\t\t\t\tx => this.onData( x ),\r\n\t\t\t\t\te => this.onError( e.error ));\r\n\t\t}\r\n\t}\r\n\r\n\tprivate onData( x ){\r\n\t\tthis.data$.emit( {\r\n\t\t\tdatasets: this.converter.toDataSets( x )\r\n\t\t} );\r\n\t}\r\n\r\n\tprivate onError(err) {\r\n\t\t// \tthis.chart.data.datasets = []\r\n\t\t//  this.chart.update();\r\n\t\t//  this.chart.widget.error = err.details;\r\n\t}\r\n}","export enum AxisUnitType {\r\n\tNone, \r\n\r\n\tCommon_Short,\r\n\tCommon_Percent,\r\n\tCommon_Percent01,\r\n\tCommon_Humidity,\r\n\tCommon_Decibel,\r\n\tCommon_Hex0x,\r\n\tCommon_Hex,\r\n\tCommon_SciNotation,\r\n\tCommon_LocaleString,\r\n\r\n\tLength_Millimetre,\r\n\tLength_Meter,\r\n\tLength_Feet,\r\n\tLength_Kilometer,\r\n\tLength_Mile,\r\n\r\n\tArea_SquareMeters,\r\n\tArea_SquareFeet,\r\n\tArea_SquareMiles,\r\n\r\n\tMass_Milligram,\r\n\tMass_Gram,\r\n\tMass_Kilogram,\r\n\tMass_MetricTon\r\n}\r\n\r\nexport class AxisUnit{\r\n\tconstructor( \r\n\t\tpublic type: AxisUnitType,\r\n\t\tpublic label: string,\r\n\t\tpublic unit: string,\r\n\t\tpublic command?: (event?: any) => void ){}\r\n}\r\n\r\nexport class AxisUnitHelper{\r\n\tstatic getData( unit: AxisUnitType ){\r\n\t\tswitch( +unit ){\r\n\r\n\t\t\tcase AxisUnitType.Common_Short:\r\n\t\t\t\treturn new AxisUnit( AxisUnitType.Common_Short, \"short\", \"\" );\r\n\r\n\t\t\tcase AxisUnitType.Common_Percent:\r\n\t\t\t\treturn new AxisUnit( AxisUnitType.Common_Percent, \"percent (0-100)\", \"%\" );\r\n\r\n\t\t\tcase AxisUnitType.Common_Percent01:\r\n\t\t\t\treturn new AxisUnit( AxisUnitType.Common_Percent01, \"percent (0.0-1.0)\", \"%\" );\r\n\r\n\t\t\tcase AxisUnitType.Common_Humidity:\r\n\t\t\t\treturn new AxisUnit( AxisUnitType.Common_Humidity, \"humidity (%H)\", \"%H\" );\r\n\r\n\t\t\tcase AxisUnitType.Common_Decibel:\r\n\t\t\t\treturn new AxisUnit( AxisUnitType.Common_Decibel, \"decibel\", \"dB\" );\r\n\r\n\t\t\tcase AxisUnitType.Common_Hex0x:\r\n\t\t\t\treturn new AxisUnit( AxisUnitType.Common_Hex0x, \"hexadecimal (0x)\", \"\" );\r\n\r\n\t\t\tcase AxisUnitType.Common_Hex:\r\n\t\t\t\treturn new AxisUnit( AxisUnitType.Common_Hex, \"hexadecimal\", \"\" );\r\n\r\n\t\t\tcase AxisUnitType.Common_SciNotation:\r\n\t\t\t\treturn new AxisUnit( AxisUnitType.Common_SciNotation, \"scientific notation\", \"\" );\r\n\r\n\t\t\tcase AxisUnitType.Common_LocaleString:\r\n\t\t\t\treturn new AxisUnit( AxisUnitType.Common_LocaleString, \"locale string\", \"\" );\r\n\r\n\r\n\r\n\t\t\tcase AxisUnitType.Length_Millimetre:\r\n\t\t\t\treturn new AxisUnit( AxisUnitType.Length_Millimetre, \"millimetre (mm)\", \"mm\" );\r\n\r\n\t\t\tcase AxisUnitType.Length_Meter:\r\n\t\t\t\treturn new AxisUnit( AxisUnitType.Length_Meter, \"meter (m)\", \"m\" );\r\n\r\n\t\t\tcase AxisUnitType.Length_Feet:\r\n\t\t\t\treturn new AxisUnit( AxisUnitType.Length_Feet, \"feet (ft)\", \"ft\" );\r\n\r\n\t\t\tcase AxisUnitType.Length_Kilometer:\r\n\t\t\t\treturn new AxisUnit( AxisUnitType.Length_Kilometer, \"kilometer (km)\", \"km\" );\r\n\r\n\t\t\tcase AxisUnitType.Length_Mile:\r\n\t\t\t\treturn new AxisUnit( AxisUnitType.Length_Mile, \"mile (mi)\", \"mi\" );\r\n\r\n\r\n\r\n\r\n\r\n\t\t\tcase AxisUnitType.Area_SquareMeters:\r\n\t\t\t\treturn new AxisUnit( AxisUnitType.Area_SquareMeters, \"Square Meters (m²)\", \"m²\" );\r\n\r\n\t\t\tcase AxisUnitType.Area_SquareFeet:\r\n\t\t\t\treturn new AxisUnit( AxisUnitType.Area_SquareFeet, \"Square Feet (ft²)\", \"ft²\" );\r\n\r\n\t\t\tcase AxisUnitType.Area_SquareMiles:\r\n\t\t\t\treturn new AxisUnit( AxisUnitType.Area_SquareMiles, \"Square Miles (mi²)\", \"mi²\" );\r\n\r\n\r\n\t\t\tcase AxisUnitType.Mass_Milligram:\r\n\t\t\t\treturn new AxisUnit( AxisUnitType.Mass_Milligram, \"milligram (mg)\", \"mg\" );\r\n\r\n\t\t\tcase AxisUnitType.Mass_Gram:\r\n\t\t\t\treturn new AxisUnit( AxisUnitType.Mass_Gram, \"gram (g)\", \"g\" );\r\n\r\n\t\t\tcase AxisUnitType.Mass_Kilogram:\r\n\t\t\t\treturn new AxisUnit( AxisUnitType.Mass_Kilogram, \"kilogram (kg)\", \"kg\" );\r\n\r\n\t\t\tcase AxisUnitType.Mass_MetricTon:\r\n\t\t\t\treturn new AxisUnit( AxisUnitType.Mass_MetricTon, \"metric ton (t)\", \"t\" );\r\n\t\t}\r\n\r\n\t\treturn new AxisUnit( AxisUnitType.None, \"none\", \"\" );\r\n\t}\r\n\r\n\tstatic getFormattedValue( label, unit, decimals ){\r\n\t\tlet value = label.toFixed( decimals );\r\n\t\tconst unitData = AxisUnitHelper.getData( unit);\r\n\r\n\t\tswitch( unitData.type ){\r\n\t\t\tcase AxisUnitType.Common_Hex: \r\n\t\t\t\treturn label.toString( 16 );\r\n\r\n\t\t\tcase AxisUnitType.Common_Hex0x: \r\n\t\t\t\treturn `0x${label.toString( 16 )}`;\r\n\r\n\t\t\tcase AxisUnitType.Common_Percent01: \r\n\t\t\t\treturn `${( 100 * label ).toFixed( decimals )} %`;\r\n\r\n\t\t\tcase AxisUnitType.Common_SciNotation: \r\n\t\t\t\treturn label.toExponential(decimals);\r\n\r\n\t\t\tcase AxisUnitType.Common_LocaleString:\r\n\t\t\t\treturn label.toLocaleString();\r\n\r\n\t\t\tcase AxisUnitType.Common_Short:\r\n\t\t\t\treturn AxisUnitHelper.getShortFormattedValue( label, unit, decimals );\r\n\r\n\t\t\tcase AxisUnitType.None:\r\n\t\t\t\treturn value;\r\n\r\n\r\n\r\n\t\t\tdefault: \r\n\t\t\t\treturn `${value} ${unitData.unit}`;\r\n\t\t}\r\n\t}\r\n\r\n\tstatic getShortFormattedValue( label, unit, decimals ){\r\n\t\t// if( label < 1000 ){\r\n\t\t// \treturn label;\r\n\t\t// }\r\n\t\t\r\n\t\tlet dev = 1;\r\n\t\tlet u = '';\r\n\r\n\t\tif( label >= 1000 && label < 1000000 ){\r\n\t\t\tu = 'K';\r\n\t\t\tdev = 1000;\r\n\t\t} else if( label >= 1000000 && label < 1000000000 ){\r\n\t\t\tu = 'Mil';\r\n\t\t\tdev = 1000000;\r\n\t\t}\r\n\t\telse if( label >= 1000000000 && label < 1000000000000 ){\r\n\t\t\tu = 'Bil';\r\n\t\t\tdev = 1000000000;\r\n\t\t} else if( label >= 1000000000000 && label < 1000000000000000 ){\r\n\t\t\tu = 'Tri';\r\n\t\t\tdev = 1000000000000;\r\n\t\t}\r\n\t\telse if( label >= 1000000000000000 && label < 1000000000000000000 ){\r\n\t\t\tu = 'Qdr';\r\n\t\t\tdev = 1000000000000000;\r\n\t\t}\r\n\r\n\t\treturn  `${( label / dev ).toFixed( decimals)} ${u}`;\r\n\t}\r\n} ","import { Moment } from 'common';\r\nimport * as moment from 'moment';\r\nimport { ChartComponent } from '../../chart.c';\r\nimport { AxisUnitHelper } from '../axes/unit-helper';\r\nimport { ColorHelper } from '../render/color-helper';\r\n\r\ndeclare var Chart: any;\r\ndeclare var $: any;\r\n\r\nexport class TooltipBuilder {\r\n\r\n\tstatic readonly ID = \"chartjs-tooltip\";\r\n\tstatic readonly TOOLTIP_SELECTOR = \"ed-tooltip\";\r\n\r\n\tstatic build( comp: ChartComponent ){\r\n\t\tChart.Tooltip.positioners.custom = function (elements, eventPosition) {\r\n\t\t\t/** @type {Chart.Tooltip} */\r\n\t\t\tvar tooltip = this;\r\n\r\n\t\t\treturn {\r\n\t\t\t\tx: eventPosition.x,\r\n\t\t\t\ty: eventPosition.y\r\n\t\t\t};\r\n\t\t};\r\n\r\n\t\treturn {\r\n\t\t\tmode: 'index',\r\n\t\t\tposition: \"custom\",\r\n\t\t\taxis: 'x',\r\n\t\t\tintersect: false,\r\n\t\t\tcaretSize: 0,\r\n\t\t\txPadding: 10,\r\n\t\t\tbodySpacing: 5,\r\n\t\t\ttitleAlign: 'right',\r\n\t\t\tenabled: false,\r\n\t\t\tcustom: ( model ) => TooltipBuilder.createCustomElement(model, comp)\r\n\t\t}\r\n\t}\r\n\r\n\tprivate static createCustomElement( tooltipModel, comp: ChartComponent ){\r\n\t\tvar tooltipEl = TooltipBuilder.getRootElement();\r\n\t\t\r\n\t\t// Hide if no tooltip\r\n\t\tif( tooltipModel.opacity === 0 /*|| chart.showAnnotView*/ ) {\r\n\t\t\ttooltipEl.style.opacity = '0';\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\ttooltipEl.classList.remove('above', 'below', 'no-transform');\r\n\t\t\r\n\t\tif (tooltipModel.yAlign) {\r\n\t\t\t\ttooltipEl.classList.add(tooltipModel.yAlign);\r\n\t\t} else {\r\n\t\t\t\ttooltipEl.classList.add('no-transform');\r\n\t\t}\r\n\r\n\t\tif (tooltipModel.body) {\r\n\t\t\tTooltipBuilder.createBody( tooltipModel, comp, tooltipEl );\r\n\t\t}\r\n\r\n\t\tTooltipBuilder.setPosition(tooltipModel, comp, tooltipEl );\r\n\t}\r\n\r\n\tprivate static setPosition(tooltipModel, comp: ChartComponent, tooltipEl){\r\n\t\tconst chart = comp.control.chart;\r\n\r\n\t\tvar position = chart\r\n\t\t\t.canvas\r\n\t\t\t.getBoundingClientRect();\r\n\r\n\t\tconst elWidth = document\r\n\t\t\t.getElementsByClassName(TooltipBuilder.TOOLTIP_SELECTOR)[ 0 ]\r\n\t\t\t.getBoundingClientRect()\r\n\t\t\t.width;\r\n\r\n\t\tconst negMargin = ( tooltipModel.caretX + elWidth > position.width ) ?\r\n\t\t\telWidth +  2 * tooltipModel.xPadding : 0;\r\n\t\t\r\n\t\ttooltipEl.style.opacity = '1';\r\n\t\ttooltipEl.style.position = 'absolute';\r\n\t\ttooltipEl.style.left = position.left + window.pageXOffset + tooltipModel.caretX - negMargin + 'px';\r\n\t\ttooltipEl.style.top = position.top + window.pageYOffset + tooltipModel.caretY + 'px';\r\n\t\ttooltipEl.style.fontFamily = tooltipModel._bodyFontFamily;\r\n\t\ttooltipEl.style.padding = tooltipModel.yPadding + 'px ' + tooltipModel.xPadding + 'px';\r\n\t\ttooltipEl.style.pointerEvents = 'none';\r\n\t}\r\n\r\n\tprivate static createBody( tooltipModel, comp: ChartComponent, tooltipEl ){\r\n\r\n\t\tconst chart = comp.control.chart;\r\n\r\n\t\tvar titleLines = tooltipModel.title || [];\r\n\t\tvar innerHtml = '';\r\n\r\n\t\ttitleLines.forEach(function(title) {\r\n\t\t\tconst date = Date.parse( title );\r\n\t\t\tconst time = Moment.format ( date );\r\n\t\t\tinnerHtml += `<div style=\"${TooltipBuilder.classGraphTime}\">${time}</div>`\r\n\t\t});\r\n\r\n\t\tconst parsedBodyLines = TooltipBuilder.sort( tooltipModel, chart );\r\n\r\n\t\tparsedBodyLines.forEach(function(body, i) {\r\n\t\t\tconst { seriesName, value, colorFunc } = body;\r\n\r\n\t\t\tlet seriesNameEl = `\r\n\t\t\t\t<div style=\"${TooltipBuilder.classSeriesName}\">\r\n\t\t\t\t\t<i class=\"fa fa-minus\" style=\"color:${colorFunc};\"></i> ${seriesName}:\r\n\t\t\t\t</div>`\r\n\r\n\t\t\tconst w = comp.store.panel.widget;\r\n\r\n\t\t\tconst ds = chart\r\n\t\t\t\t.data\r\n\t\t\t\t.datasets\r\n\t\t\t\t.find( x => x.label == seriesName );\r\n\r\n\t\t\tconst axis =  ( ds.yAxisID == 'A' ) ?\tw.axes.leftY : w.axes.rightY;\r\n\r\n\t\t\tconst decimals = w.legend.decimals ? w.legend.decimals : 1;\r\n\r\n\t\t\tconst resValue = AxisUnitHelper.getFormattedValue( value, axis.unit, decimals )\r\n\r\n\t\t\tlet valueEl = `<div style=\"${TooltipBuilder.classSeriesValue}\">${resValue}</div>`;\r\n\r\n\t\t\tlet item = `\r\n\t\t\t\t<div style=\"display: table-row\">\r\n\t\t\t\t\t${seriesNameEl}\r\n\t\t\t\t\t${valueEl}\r\n\t\t\t\t</div>`\r\n\r\n\t\t\tinnerHtml += item;\r\n\t\t});\r\n\r\n\t\tvar tableRoot = tooltipEl.querySelector(`.${TooltipBuilder.TOOLTIP_SELECTOR}`);\r\n\t\ttableRoot.innerHTML = innerHtml;\r\n\t}\r\n\r\n\tprivate static sort( tooltipModel, chart ) : Array<any>{\r\n\t\tfunction getBody(bodyItem) {\r\n\t\t\treturn bodyItem.lines;\r\n\t\t}\r\n\r\n\t\tvar bodyLines = tooltipModel.body.map(getBody);\r\n\r\n\t\t// const sortOrder = +chart\r\n\t\t// \t.widget\r\n\t\t// \t.display\r\n\t\t// \t.tooltipSortOrder;\r\n\r\n\t\tconst parsedBodyLines = [];\r\n\t\t\r\n\t\tbodyLines.forEach(function(body, i) {\r\n\t\t\tvar colors = tooltipModel.labelColors[ i ];\r\n\t\t\tvar color = ColorHelper.parse( colors.backgroundColor);\r\n\t\t\tvar colorFunc = `rgba(${color.r},${color.g},${color.b},1)`\r\n\r\n\t\t\tlet index = body[ 0 ].lastIndexOf( ':' );\r\n\t\t\tconst seriesName = body[ 0 ].substring( 0, index );\r\n\t\t\tconst value = parseFloat(tooltipModel.dataPoints[ i ].value);\r\n\t\t\tparsedBodyLines.push( {seriesName, value, colorFunc} );\r\n\t\t});\r\n\r\n\t\t// switch( sortOrder ){\r\n\t\t// \t// case CartesianChart.TooltipSortOrder.Increasing:\r\n\t\t// \t// \tparsedBodyLines.sort( (a, b) => a.value - b.value);\r\n\t\t// \t// \tbreak;\r\n\r\n\t\t// \t// case CartesianChart.TooltipSortOrder.Decreasing:\r\n\t\t// \t// \tparsedBodyLines.sort( (a, b) => b.value - a.value);\r\n\t\t// \t// \tbreak;\r\n\t\t// }\r\n\r\n\t\treturn parsedBodyLines;\r\n\t}\r\n\r\n\tprivate static getRootElement(){\r\n\t\tvar tooltipEl = document.getElementById(TooltipBuilder.ID);\r\n\r\n\t\t\t// Create element on first render\r\n\t\tif(!tooltipEl) {\r\n\t\t\ttooltipEl = document.createElement('div');\r\n\t\t\ttooltipEl.id = TooltipBuilder.ID;\r\n\r\n\t\t\ttooltipEl.innerHTML = `<div style=\"${TooltipBuilder.classGraphTooltip};\t${TooltipBuilder.classGraphanaTooltip}\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass='${TooltipBuilder.TOOLTIP_SELECTOR}'></div>`;\r\n\r\n\t\t\tdocument.body.appendChild(tooltipEl);\r\n\t\t}\r\n\r\n\t\treturn tooltipEl;\r\n\t}\r\n\r\n\tprivate static get classGraphTooltip() {\r\n\t\treturn `\r\n\t\t\twhite-space: nowrap;\r\n\t\t\tfont-size: 12px;\r\n\t\t\tbackground-color: #141414;\r\n\t\t\tcolor: #d8d9da;`\r\n\t}\r\n\r\n\tprivate static get classGraphanaTooltip() {\r\n\t\treturn `\r\n\t\t\tposition: absolute;\r\n\t\t\tpadding: 10px;\r\n\t\t\tfont-weight: 200;\r\n\t\t\tborder-radius: 5px;\r\n\t\t\tz-index: 9999;\r\n\t\t\tmax-width: 800px;\r\n\t\t\tmax-height: 600px;\r\n\t\t\toverflow: hidden;\r\n\t\t\tline-height: 14px;`\r\n\t}\r\n\r\n\tprivate static get classGraphTime() {\r\n\t\treturn `\r\n\t\t\ttext-align: center;\r\n\t\t\tposition: relative;\r\n\t\t\ttop: -3px;\r\n\t\t\tpadding: .2rem;\r\n\t\t\tfont-weight: 700;\r\n\t\t\tcolor: #d8d9da;`\r\n\t}\r\n\r\n\tprivate static get classSeriesName() {\r\n\t\treturn `\r\n\t\t\tdisplay: table-cell;\r\n\t\t\tpadding: .15rem;\r\n\t\t\tmax-width: 650px;\r\n\t\t\ttext-overflow: ellipsis;\r\n\t\t\toverflow: hidden;\r\n\t\t\tfont-weight: 400;`\r\n\t}\r\n\r\n\tprivate static get classSeriesValue() {\r\n\t\treturn `\r\n\t\t\tdisplay: table-cell;\r\n\t\t\tfont-weight: 700;\r\n\t\t\tpadding-left: 15px;\r\n\t\t\ttext-align: right;`\r\n\t}\r\n\r\n\r\n\r\n\r\n\r\n}\r\n\r\n\r\n","import { ChartComponent } from '../chart.c';\r\nimport { TooltipBuilder } from './extensions/tooltip-builder';\r\n\r\ndeclare var Chart: any;\r\n\r\nexport class OptionsProvider{\r\n\t\r\n\r\n\tstatic getOptions( comp: ChartComponent ){\r\n\t\tChart.defaults.global.defaultFontColor = '#e3e3e3';\r\n\t\tChart.defaults.global.defaultFontFamily = 'Roboto';\r\n\t\tChart.defaults.global.defaultFontSize = 11;\r\n\r\n\t\tconst axisYa = {\r\n\t\t\tid: 'A',\r\n\t\t\tgridLines: {\r\n\t\t\t\tcolor: 'rgba( 255,255,255, 0.1)',\r\n\t\t\t\tzeroLineWidth: 3,\r\n\t\t\t},\r\n\t\t}\r\n\r\n\t\tconst axisYb = {\r\n\t\t\tid: 'B',\r\n\t\t\tposition: 'right'\r\n\t\t}\r\n\r\n\t\treturn {\r\n\t\t\tmaintainAspectRatio: false,\r\n\t\t\tanimation: false,\r\n\r\n\t\t\ttooltips: TooltipBuilder.build( comp ),\r\n\r\n\t\t\tlegend: {\r\n\t\t\t\tdisplay: false\r\n\t\t\t},\r\n\t\r\n\t\t\tspanGaps: true,\r\n\r\n\t\t\tscales: {\r\n\t\t\t\txAxes: [{\r\n\t\t\t\t\ttype: 'time',\r\n\t\t\t\t\tgridLines: {\r\n\t\t\t\t\t\tcolor: 'rgba( 255,255,255, 0.1)',\r\n\t\t\t\t\t},\r\n\t\t\t\t\tticks: {\r\n\t\t\t\t\t\tautoSkip: true,\r\n\t\t\t\t\t\tautoSkipPadding: 50,\r\n\t\t\t\t\t\tmaxRotation: 0,\r\n\t\t\t\t\t\tminRotation: 0,\r\n\t\t\t\t\t},\r\n\t\t\t\t\ttime: {\r\n\t\t\t\t\t\tdisplayFormats: {\r\n\t\t\t\t\t\t\tsecond: 'HH:mm:ss',\r\n\t\t\t\t\t\t\tminute: 'HH:mm',\r\n\t\t\t\t\t\t\thour: 'HH:mm',\r\n\t\t\t\t\t\t\tday: 'M/D HH:mm',\r\n\t\t\t\t\t\t\tweek: 'M/D',\r\n\t\t\t\t\t\t\tmonth: 'M/D',\r\n\t\t\t\t\t\t\tyear: 'YYYY-M',\r\n\t\t\t\t\t\t },\r\n\r\n\t\t\t\t\t\t //stepSize: 30\r\n\t\t\t\t\t},\r\n\t\t\t\t\r\n\r\n\t\t\t\t\r\n\t\t\t\t}],\r\n\t\t\t\tyAxes: /*!AxesManager.needSecondaryYAxis(widget)*/true ? [axisYa] : [axisYa, axisYb]\r\n\t\t\t\t\r\n\t\t\t},\r\n\t\t};\r\n\t}\r\n}","import { Inject, Injectable } from '@angular/core';\nimport { Panel, PANEL_TOKEN } from 'common';\nimport { UIChart } from 'primeng';\nimport { BehaviorSubject, Observable } from 'rxjs';\nimport { Chart, DataSet } from '../chart.m';\nimport { DataProvider } from '../view/data/data-provider';\nimport { DisplayManager } from '../view/render/display-manager';\n\n@Injectable()\nexport class ChartStore {\n\n\tprivate widget: BehaviorSubject<Chart> = new BehaviorSubject(null);\n\treadonly widget$: Observable<Chart> = this.widget.asObservable();\n\t\n\tprivate data: BehaviorSubject<DataSet[]> = new BehaviorSubject(null);\n\treadonly data$: Observable<DataSet[]> = this.data.asObservable();\n\t\n\tprivate control_: BehaviorSubject<UIChart> = new BehaviorSubject(null);\n\treadonly control$: Observable<UIChart> = this.control_.asObservable();\n\n\tget control() : UIChart{\n\t\treturn this.control_.value; \n\t}\n\n\tset control( ctrl: UIChart ){\n\t\tthis.control_.next( ctrl );\n\t}\n\n\tconstructor( \n\t\tpublic dataProvider: DataProvider,\n\t\tpublic display: DisplayManager,\n\t\t@Inject( PANEL_TOKEN ) public panel: Panel ){\n\n\t\t\tdataProvider\n\t\t\t\t.data$\n\t\t\t\t.subscribe( x => this.data.next( x?.datasets ?? [] ) );\n\n\t\t\tthis.widget.next( panel.widget );\n\t}\n\n\t\n\n\tdestroy(){\n\t\tthis.dataProvider.destroy();\n\t}\n}\n","import { Directive } from '@angular/core';\nimport { UIChart } from 'primeng';\nimport { Subscription } from 'rxjs';\nimport { Chart, ChartData, DataSet } from '../chart.m';\nimport { ChartStore } from './chart.store';\n\n@Directive() \nexport class BaseChartComponent {\n  data: ChartData;\n  widget: Chart;\n  control: UIChart;\n\n  get datasets():DataSet[]{\n    return this.data?.datasets;\n  }\n\n  dataSubs: Subscription;\n  widgetSubs: Subscription;\n  ctrlSubs: Subscription;\n\n  get display(){\n    return this.store.display;\n  }\n\n\tconstructor( public store: ChartStore ){\n\n    this.dataSubs = store\n      .data$\n      .subscribe( x => this.data = { \n        datasets: x\n      } );\n\n    this.widgetSubs = store\n      .widget$\n      .subscribe( x => {\n        this.widget = x;\n\n        if( x ){\n          this.onWidgetReady();\n        }\n       } );\n\n    this.ctrlSubs = store\n      .control$\n      .subscribe( x => {\n        this.control = x;\n\n        if( x ){\n          this.onControlReady();\n        }\n      } );\n  }\n\n  onWidgetReady(){\n\n  }\n\n  onControlReady(){\n\n  }\n  \n  ngOnDestroy(){\n    this.dataSubs?.unsubscribe();\n    this.widgetSubs?.unsubscribe();\n    this.ctrlSubs?.unsubscribe();\n\t}\n}\n","<div class=\"legend__top-wrapper\">\n\n\t<div *ngIf=\"!legend.table; else legendAsTable\" class=\"legend__bottom\" [ngStyle]=\"widthStyle\"   >\n\t\t<perfect-scrollbar>\n\t\t\t\t\n\t\t\t<div class=\"legend__scroller-cont\"  >\n\n\t\t\t\t<div class=\"legend__series-wrapper\" [@fadeInOut] *ngIf=\"datasets?.length\"  >\n\t\t\t\t\t<div *ngFor=\"let ds of datasets\" class=\"legend__series\"\n\t\t\t\t\t (click)=\"onSeriesClicked(ds, $event)\" [ngClass]=\"{'hidden': ds.hidden }\">\n\n            <div class=\"legend__icon\" [style.color]=\"color( ds )\">\n              <i class=\"fa fa-minus pointer\" ></i>\n            </div>\n              \n            <a class=\"legend__alias pointer\" [title]=\"ds.label\">{{ds.label}}</a>\n\n            <div class=\"legend__value min\" *ngIf=\"legend.min\">{{min(ds)}}</div>\n\n            <div class=\"legend__value max\" *ngIf=\"legend.max\">{{max(ds)}}</div>\n\n            <div class=\"legend__value avg\" *ngIf=\"legend.avg\">{{avg(ds)}}</div>\n\n\t\t\t\t\t\t<div class=\"legend__value current\" *ngIf=\"legend.current\">{{current(ds)}}</div>\n\t\t\t\t\t\n\t\t\t\t\t</div>\n\t\t\t\t\t\n\t\t\t\t</div>\n\n\t\t\t\t<div class=\"legend__scroller-padding\"></div>\n\t\t\t</div>\n\n\t\t</perfect-scrollbar>\n  </div>\n  \n  <ng-template #legendAsTable>\n\t\t\n    <div class=\"legend__bottom-table\" [ngStyle]=\"widthStyle\" > \n\t\t\t<perfect-scrollbar>\n\n\t\t\t\t<div class=\"legend__scroller-cont\" [@fadeInOut] *ngIf=\"datasets?.length\">\n\n\t\t\t\t\t<div class=\"legend__series-wrapper legend__full-width\">\n\t\t\t\t\t\t<table class=\"legend__full-width\">\n\t\t\t\t\t\t\t<colgroup>\n\t\t\t\t\t\t\t\t<col class=\"legend__full-width\">\n\t\t\t\t\t\t\t</colgroup>\n\n\t\t\t\t\t\t\t<thead *ngIf=\"datasets && datasets.length > 0\">\n\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t<th style=\"text-align: left;\"></th>\n\t\t\t\t\t\t\t\t\t<th class=\"pointer\" *ngIf=\"legend.min\">min</th>\n\t\t\t\t\t\t\t\t\t<th class=\"pointer\" *ngIf=\"legend.max\">max</th>\n\t\t\t\t\t\t\t\t\t<th class=\"pointer\" *ngIf=\"legend.avg\">avg</th>\n\t\t\t\t\t\t\t\t\t<th class=\"pointer\" *ngIf=\"legend.current\">current</th>\n\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t</thead>\n\n\t\t\t\t\t\t\t<tbody>\n\t\t\t\t\t\t\t\t<tr *ngFor=\"let ds of datasets\" class=\"legend__series\" [ngClass]=\"{'hidden': ds.hidden }\">\n\n\t\t\t\t\t\t\t\t\t<td (click)=\"onSeriesClicked(ds, $event)\">\n\t\t\t\t\t\t\t\t\t\t<div class=\"legend__icon\" [style.color]=\"color(ds)\">\n\t\t\t\t\t\t\t\t\t\t\t<i class=\"fa fa-minus pointer\" ></i>\n\t\t\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t\t\t<div class=\"legend__alias pointer\" [title]=\"ds.label\">{{ds.label}}</div>\n\t\t\t\t\t\t\t\t\t</td>\n\n\t\t\t\t\t\t\t\t\t<td class=\"legend__value\" *ngIf=\"legend.min\">{{min(ds)}}</td>\n\n\t\t\t\t\t\t\t\t\t<td class=\"legend__value\" *ngIf=\"legend.max\">{{max(ds)}}</td>\n\n\t\t\t\t\t\t\t\t\t<td class=\"legend__value\" *ngIf=\"legend.avg\">{{avg(ds)}}</td>\n\n\t\t\t\t\t\t\t\t\t<td class=\"legend__value\" *ngIf=\"legend.current\">{{current(ds)}}</td>\n\n\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t</tbody>\n\t\t\t\t\t\t</table>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class=\"legend__scroller-padding\"></div>\n\n\t\t\t\t</div>\n\t\t\t</perfect-scrollbar>\n\t\t</div>\n  </ng-template>\n\n</div>","import { Component } from '@angular/core';\nimport { FadeInOutAnimation } from 'uilib';\nimport { BaseChartComponent } from '../../base/chart-base';\nimport { ChartStore } from '../../base/chart.store';\nimport { DataSet } from '../../chart.m';\nimport { AxisUnitHelper } from '../axes/unit-helper';\nimport { DisplayManager } from '../render/display-manager';\n\n@Component({\n  selector: 'chart-legend',\n  templateUrl: './legend.html',\n  styleUrls:[ './legend.scss' ],\n  animations: [FadeInOutAnimation],\n})\nexport class ChartLegendComponent extends BaseChartComponent {\n\n  get legend(){\n    return this.widget.legend;\n  }\n\n  public get widthStyle(){\n    return {}\n\t\t// return { \n\t\t// \t'width': this.widget.width && this.widget.right ? this.widget.width + 'px' : '100%'\n\t\t// }\n\t}\n\n  constructor( store: ChartStore ) {\n    super( store );\n  }\n\n  axis( ds: DataSet ){\n    const x = (<any>this.widget).axes\n    //return ( ds.yAxisID == 'A' ) ?x.leftY :x.rightY\n    return x.leftY;\n  }\n  \n  decimals( ds: DataSet ){\n\t\treturn this.legend.decimals ? this.legend.decimals : 1;\n\t}\n\n  unit( ds: DataSet ){\n\t\treturn this.axis( ds ).unit;\n  }\n  \n  color( ds: DataSet ){\n    return this\n\t\t  .display\n\t\t\t.getLineColor( ds, 1 );\n\t}\n\n  min( ds: DataSet ){\n\t\treturn AxisUnitHelper.getFormattedValue( ds.min, this.unit( ds ), this.decimals( ds ) )\n\t}\n\n\tmax( ds: DataSet ){\n\t\treturn AxisUnitHelper.getFormattedValue( ds.max,\tthis.unit( ds ), this.decimals( ds ) )\n\t}\n\n\tavg( ds: DataSet ){\n\t\treturn AxisUnitHelper.getFormattedValue( ds.avg, this.unit( ds ), this.decimals( ds ) )\n\t}\n\n\tcurrent( ds: DataSet ){\n\t\treturn AxisUnitHelper.getFormattedValue( ds.current, this.unit( ds ), this.decimals( ds ) )\n\t}\n\n\n  onSeriesClicked( ds: DataSet, e: any ){\n    if( e.ctrlKey ){\n\t\t\tconst selected = ( false == ds.selected );\n\n\t\t\tthis.toggleSeries( ds, selected );\n\t\t} else{\n\t\t\tconst selected = ( ( undefined === ds.selected ) || false == ds.selected ) ?\n\t\t\t\ttrue : undefined;\n\n\t\t\tthis.toggleSeries( ds, selected );\n\t\n\t\t\tthis\n\t\t\t\t.datasets\n\t\t\t\t.filter( x => x != ds )\n\t\t\t\t.forEach( x => this.toggleSeries( x,  true == selected ? false : undefined ) );\n\t\t}\n\t\n\t\tthis.control.refresh();\n  }\n\n  toggleSeries( ds: DataSet, selected: boolean ){\n\t\tds.selected = selected;\n\n\t\tif( undefined === selected ){\n\t\t\tdelete ds.hidden;\n\t\t\tdelete ds.selected;\n\t\t} else {\n\t\t\tds.hidden = !selected;\n\t\t}\n\t}\n  \n}\n","<div class=\"chart__wrapper\">\n\n  <div class=\"chart__right-legend-cont\">\n\n    <div class=\"chart__canvas-cont\">\n      <p-chart \n        type=\"line\"\n        [data]=\"data\"\n        [options]=\"options\"\n        [plugins]=\"plugins\"\n        height=\"100%\" #chart>\n      </p-chart>\n    </div>\n\n    <chart-legend *ngIf=\"legend.show && legend?.right\" class=\"chart__legend-right\"></chart-legend>\n    \n  </div>\n\n  <chart-legend *ngIf=\"legend.show && !legend?.right\" class=\"chart__legend-bottom\"></chart-legend>\n\n</div>\n\n","import { Component, ViewChild } from '@angular/core';\nimport { TrackballDrawerPlugin } from './view/extensions/trackball-drawer';\nimport { DataProvider } from './view/data/data-provider';\nimport { OptionsProvider } from './view/options-provider';\nimport { DataConverter } from './view/data/data-converter';\nimport { DisplayManager } from './view/render/display-manager';\nimport { ChartStore } from './base/chart.store';\nimport { UIChart } from 'primeng';\nimport { BaseChartComponent } from './base/chart-base';\n\n@Component({\n  selector: 'widget',\n  templateUrl:'./chart.html',\n  styleUrls: ['./chart.scss'],\n  providers:[\n    DataProvider,\n    DataConverter,\n    DisplayManager,\n    ChartStore\n  ]\n})\nexport class ChartComponent extends BaseChartComponent {\n  \n  options: any;\n  plugins = [ new TrackballDrawerPlugin() ]\n  @ViewChild( UIChart ) ctrlChart;\n\n  get legend(){\n    return this.widget?.legend;\n  }\n\n  constructor( store: ChartStore ) {\n    super( store )\n\n    this.options = OptionsProvider.getOptions( this );\n  }\n\n  ngAfterViewInit(){\n    this.store.control = this.ctrlChart;\n  }\n\n  ngOnDestroy(){\n    this.store.destroy();\n  }\n}\n","import { CommonModule } from '@angular/common';\nimport { NgModule } from '@angular/core';\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\nimport { EdCommonModule } from 'common';\nimport { PerfectScrollbarModule } from 'ngx-perfect-scrollbar';\nimport { ChartModule } from 'primeng';\nimport { EdUilibModule } from 'uilib';\nimport { ChartComponent } from './chart.c';\nimport { AxesEditorComponent } from './edit/axes/axes';\nimport { ChartEditorComponent } from './edit/editor';\nimport { GeneralEditorComponent } from './edit/general/general';\nimport { LegendEditorComponent } from './edit/legend/legend';\nimport { MetricsEditorComponent } from './edit/metrics/metrics';\nimport { ChartLegendComponent } from './view/legend/legend';\n\n@NgModule({\n  declarations: [\n    ChartComponent,\n    ChartEditorComponent,\n\n    ChartLegendComponent,\n\n\n    GeneralEditorComponent,\n    MetricsEditorComponent,\n    AxesEditorComponent,\n    LegendEditorComponent,\n\n  ],\n  imports: [\n    CommonModule,\n    FormsModule,\n    ReactiveFormsModule,\n    ChartModule,\n\n    EdCommonModule,\n    EdUilibModule,\n    PerfectScrollbarModule\n  ],\n  exports: [\n    ChartComponent,\n    ChartEditorComponent\n  ],\n \n})\nexport class ChartWidgetModule { }\n"]}