!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/common"),require("@angular/core"),require("@angular/forms"),require("common"),require("primeng"),require("uilib"),require("rxjs/operators"),require("moment")):"function"==typeof define&&define.amd?define("chart",["exports","@angular/common","@angular/core","@angular/forms","common","primeng","uilib","rxjs/operators","moment"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).chart={},e.ng.common,e.ng.core,e.ng.forms,e.common,e.i3,e.uilib,e.rxjs.operators,e.moment)}(this,(function(e,t,r,n,o,i,a,u,s){"use strict";!function(){function e(){}e.alignPixel=function(e,t,r){var n=e.currentDevicePixelRatio,o=r/2;return Math.round((t-o)*n)/n+o}}();var l=function(){function e(){}return Object.defineProperty(e.prototype,"id",{get:function(){return e.ID},enumerable:!1,configurable:!0}),e.prototype.afterDatasetsDraw=function(e,t){},e.prototype.getMousePos=function(e,t){if(t){var r=e.getBoundingClientRect();return{x:t.clientX-r.left,y:t.clientY-r.top}}},e}();l.ID="trackball";var c=function(){function e(e,t,n,o,i,a){var s=this;this.pluginStore=e,this.dsService=t,this.time=n,this.pluginLoader=o,this.injector=i,this.panel=a,this.data$=new r.EventEmitter,this.error$=new r.EventEmitter,this.timeSubs=this.time.range$.pipe(u.tap((function(e){return s.request=""})),u.mergeMap((function(e){return s.pluginStore.getDataSource("influx")})),u.mergeMap((function(e){return s.pluginLoader.loadDataSourceQueryCompiler(e,s.injector)})),u.mergeMap((function(e){return e.compile(s.metrics,n.range)}))).subscribe((function(e){return s.pull(e)}))}return Object.defineProperty(e.prototype,"metrics",{get:function(){var e,t;return null===(t=null===(e=this.panel)||void 0===e?void 0:e.widget)||void 0===t?void 0:t.metrics},enumerable:!1,configurable:!0}),e.prototype.destroy=function(){var e;null===(e=this.timeSubs)||void 0===e||e.unsubscribe()},e.prototype.pull=function(e){var t=this;this.request!==e&&(this.request=e,console.log("pull: "+e),e?(this.panel.loading=!0,this.dsService.proxy(6,e).pipe(u.finalize((function(){return t.panel.loading=!1}))).subscribe((function(e){return t.data$.emit(e)}),(function(e){return t.error$.emit(e.error)}))):this.data$.emit([]))},e}();c.ɵfac=function(e){return new(e||c)(r.ɵɵinject(o.PluginStore),r.ɵɵinject(o.DataSourceService),r.ɵɵinject(o.TimeRangeStore),r.ɵɵinject(o.PluginLoader),r.ɵɵinject(r.Injector),r.ɵɵinject("panel"))},c.ɵprov=r.ɵɵdefineInjectable({token:c,factory:c.ɵfac});function p(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a}function d(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(p(arguments[t]));return e}var f=function(){function e(){this.palette=new Array,this.palette=["7eb26d","cca300","6ed0e0","EF843C","E24D42","1F78C1","BA43A9","705DA0","508642","CCA300","447EBC","C15C17","890F02","0A437C","6D1F62","584477","B7DBAB","F4D598","70DBED","F9BA8F","F29191","82B5D8","E5A8E2","AEA2E0","629E51","E5AC0E","64B0C8","E0752D","BF1B00","0A50A1","962D82","614D93","9AC48A","F2C96D","65C5DB","F9934E","5195CE","D683CE","806EB7","3F6833","967302","2F575E","99440A","58140C","052B51","511749","3F2B5B","E0F9D7","FCEACA","CFFAFF","F9E2D2","FCE2DE","BADFF4","F9D9F9","DEDAF7","EA6460"]}return e.prototype.getColor=function(e){var t=this.palette[e.index%this.palette.length];return this.hexToRgb(t)},e.prototype.getColorAsArgbFunc=function(e,t){void 0===t&&(t=1);var r=this.getColor(e);return"rgba("+r.r+","+r.g+","+r.b+", "+t+")"},e.prototype.hexToRgb=function(e){var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:null},e.parse=function(e){var t=[];if("#"==e.substr(0,1)){var r=(e.length-1)/3,n=[17,1,.062272][r-1];t=[Math.round(parseInt(e.substr(1,r),16)*n),Math.round(parseInt(e.substr(1+r,r),16)*n),Math.round(parseInt(e.substr(1+2*r,r),16)*n)]}else t=e.split("(")[1].split(")")[0].split(",").map(Math.round);return{r:t[0],g:t[1],b:t[2]}},e.rgbToHex=function(t){var r=e.parse(t);return"#"+r.r.toString(16).padStart(2,"0")+r.g.toString(16).padStart(2,"0")+r.b.toString(16).padStart(2,"0")},e}(),m=function(){function e(e){var t=this;this.dataProvider=e,this.dataSets$=new r.EventEmitter,this.dataReadySubs=this.dataProvider.data$.subscribe((function(e){return t.rebuild(e)})),this.errorSubs=this.dataProvider.error$.subscribe((function(e){return t.error(e)}))}return e.prototype.rebuild=function(e){var t=this;if(e&&0!==e.length){var r=[],n=0;e.forEach((function(e){var o=d(e.columns.slice(1).map((function(r,o){return t.getDataSet(e,o+1,n++)}))).filter((function(e){return e}));r=d(r,o)})),this.dataSets$.emit(r)}else this.dataSets$.emit([])},e.prototype.error=function(e){},e.prototype.getDataSet=function(e,t,r){var n=e.values.map((function(e){var r=null==e[t];return{x:o.Moment.valueOf(e[0]),y:e[t],isNull:r}})),i=n.map((function(e){return e.y})).filter((function(e){return null!=e})).map((function(e){return parseFloat(e)}));if(0!=i.length){var a=i.reduce((function(e,t){return e+t}))/i.length,u=i.every((function(e){return null==e})),s=i.every((function(e){return 0==e})),l={label:this.generateDataSetName(e,t),data:n,lineTension:0,min:Math.min.apply(Math,d(i)),max:Math.max.apply(Math,d(i)),avg:a,current:i.slice(-1)[0],allNulls:u,allZeros:s,index:r,pointRadius:0,borderColor:null};return l.borderColor=(new f).getColorAsArgbFunc(l,1),l}},e.prototype.generateDataSetName=function(e,t){var r=e.name+"."+e.columns[t],n="",o=(Object.keys(e.tags),0);for(var i in e.tags)n+=(o>0?", ":"")+i+": "+e.tags[i],o++;return n&&(r=r+" {"+n+"}"),r},e}();m.ɵfac=function(e){return new(e||m)(r.ɵɵinject(c))},m.ɵprov=r.ɵɵdefineInjectable({token:m,factory:m.ɵfac});var g=function(){function e(e,t){var r=this;this.dataProvider=e,this.seriesManager=t,this.plugins=[new l],t.dataSets$.subscribe((function(e){return r.data={datasets:e}}));var n={id:"A",gridLines:{color:"rgba( 255,255,255, 0.1)",zeroLineWidth:3}};this.options={maintainAspectRatio:!1,animation:!1,legend:{display:!1},spanGaps:!0,scales:{xAxes:[{type:"time",gridLines:{color:"rgba( 255,255,255, 0.1)"},ticks:{autoSkip:!0,autoSkipPadding:50,maxRotation:0,minRotation:0},time:{displayFormats:{second:"HH:mm:ss",minute:"HH:mm",hour:"HH:mm",day:"M/D HH:mm",week:"M/D",month:"M/D",year:"YYYY-M"}}}],yAxes:[n]}}}return e.prototype.ngOnDestroy=function(){this.dataProvider.destroy()},e}();g.ɵfac=function(e){return new(e||g)(r.ɵɵdirectiveInject(c),r.ɵɵdirectiveInject(m))},g.ɵcmp=r.ɵɵdefineComponent({type:g,selectors:[["widget"]],features:[r.ɵɵProvidersFeature([c,m,o.PluginLoader])],decls:1,vars:3,consts:[["type","line","height","100%",3,"data","options","plugins"]],template:function(e,t){1&e&&r.ɵɵelement(0,"p-chart",0),2&e&&r.ɵɵproperty("data",t.data)("options",t.options)("plugins",t.plugins)},directives:[i.UIChart],encapsulation:2});var h=function(){};h.ɵmod=r.ɵɵdefineNgModule({type:h}),h.ɵinj=r.ɵɵdefineInjector({factory:function(e){return new(e||h)},imports:[[t.CommonModule,n.FormsModule,n.ReactiveFormsModule,i.ChartModule,o.EdCommonModule,a.EdUilibModule]]}),("undefined"==typeof ngJitMode||ngJitMode)&&r.ɵɵsetNgModuleScope(h,{declarations:[g],imports:[t.CommonModule,n.FormsModule,n.ReactiveFormsModule,i.ChartModule,o.EdCommonModule,a.EdUilibModule],exports:[g]}),e.ChartComponent=g,e.ChartWidgetModule=h,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=chart.umd.min.js.map