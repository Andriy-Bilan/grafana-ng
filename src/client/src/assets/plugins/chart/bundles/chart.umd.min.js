!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("@angular/router"),require("@angular/common"),require("uilib"),require("@angular/forms"),require("common"),require("primeng"),require("rxjs/operators")):"function"==typeof define&&define.amd?define("chart",["exports","@angular/core","@angular/router","@angular/common","uilib","@angular/forms","common","primeng","rxjs/operators"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).chart={},e.ng.core,e.ng.router,e.ng.common,e.uilib,e.ng.forms,e.common,e.i2$2,e.rxjs.operators)}(this,(function(e,t,n,r,o,i,a,l,u){"use strict";var d=function(){function e(){}return e.prototype.ngOnInit=function(){console.log("create GeneralEditorComponent")},e.prototype.ngOnDestroy=function(){console.log("detroy GeneralEditorComponent")},e}();d.ɵfac=function(e){return new(e||d)},d.ɵcmp=t.ɵɵdefineComponent({type:d,selectors:[["editor-general"]],decls:1,vars:0,template:function(e,n){1&e&&t.ɵɵtext(0,"general will be here")},encapsulation:2});var s="panel",c=function(){function e(e){this.panel=e}return e.prototype.ngOnInit=function(){console.log("create MetricsComponent"),console.log(this.panel)},e.prototype.ngOnDestroy=function(){console.log("detroy MetricsComponent")},e}();c.ɵfac=function(e){return new(e||c)(t.ɵɵdirectiveInject(s))},c.ɵcmp=t.ɵɵdefineComponent({type:c,selectors:[["editor-metrics"]],decls:1,vars:0,template:function(e,n){1&e&&t.ɵɵtext(0,"metrics will be here")},encapsulation:2});var p=function(){function e(){}return e.prototype.ngOnInit=function(){console.log("create AxesEditorComponent")},e.prototype.ngOnDestroy=function(){console.log("detroy AxesEditorComponent")},e}();p.ɵfac=function(e){return new(e||p)},p.ɵcmp=t.ɵɵdefineComponent({type:p,selectors:[["editor-axes"]],decls:1,vars:0,template:function(e,n){1&e&&t.ɵɵtext(0,"axes will be here")},encapsulation:2});var g=function(){function e(e){this.panel=e,this.show=!0,console.log()}return Object.defineProperty(e.prototype,"legend",{get:function(){var e,t;return null===(t=null===(e=this.panel)||void 0===e?void 0:e.widget)||void 0===t?void 0:t.legend},enumerable:!1,configurable:!0}),e.prototype.ngOnInit=function(){console.log("create LegendEditorComponent")},e.prototype.ngOnDestroy=function(){console.log("detroy LegendEditorComponent")},e.prototype.onSelected=function(){console.log(this.legend)},e}();function h(e,n){1&e&&t.ɵɵelement(0,"editor-general")}function f(e,n){1&e&&t.ɵɵelement(0,"editor-metrics")}function m(e,n){1&e&&t.ɵɵelement(0,"editor-axes")}function v(e,n){1&e&&t.ɵɵelement(0,"editor-legend")}function y(e,n){1&e&&t.ɵɵtext(0," display will be here ")}function b(e,n){1&e&&t.ɵɵtext(0," alert will be here ")}function C(e,n){1&e&&t.ɵɵtext(0," time range will be here ")}g.ɵfac=function(e){return new(e||g)(t.ɵɵdirectiveInject(s))},g.ɵcmp=t.ɵɵdefineComponent({type:g,selectors:[["editor-legend"]],decls:22,vars:10,consts:[[1,"section","gf-form-group"],[1,"section-heading"],["labelWidth","7","label","Show",3,"ngModel","ngModelChange"],["labelWidth","7","label","As Table",3,"ngModel","ngModelChange"],["labelWidth","7","label","To the right",3,"ngModel","ngModelChange"],[1,"gf-form-inline"],["labelWidth","4","label","Min",3,"ngModel","ngModelChange"],["labelWidth","6","label","Min",3,"ngModel","ngModelChange"],["labelWidth","4","label","Avg",3,"ngModel","ngModelChange"],["labelWidth","6","label","Current",3,"ngModel","ngModelChange"],["labelWidth","4","label","Total",3,"ngModel","ngModelChange"],["labelWidth","10","label","With only nulls",3,"ngModel","ngModelChange"],["labelWidth","10","label","With only zeros",3,"ngModel","ngModelChange"]],template:function(e,n){1&e&&(t.ɵɵelementStart(0,"div",0),t.ɵɵelementStart(1,"h5",1),t.ɵɵtext(2,"Options"),t.ɵɵelementEnd(),t.ɵɵelementStart(3,"ed-checkbox",2),t.ɵɵlistener("ngModelChange",(function(e){return n.legend.show=e})),t.ɵɵelementEnd(),t.ɵɵelementStart(4,"ed-checkbox",3),t.ɵɵlistener("ngModelChange",(function(e){return n.legend.table=e})),t.ɵɵelementEnd(),t.ɵɵelementStart(5,"ed-checkbox",4),t.ɵɵlistener("ngModelChange",(function(e){return n.legend.right=e})),t.ɵɵelementEnd(),t.ɵɵelementEnd(),t.ɵɵelementStart(6,"div",0),t.ɵɵelementStart(7,"h5",1),t.ɵɵtext(8,"Values"),t.ɵɵelementEnd(),t.ɵɵelementStart(9,"div",5),t.ɵɵelementStart(10,"ed-checkbox",6),t.ɵɵlistener("ngModelChange",(function(e){return n.legend.min=e})),t.ɵɵelementEnd(),t.ɵɵelementStart(11,"ed-checkbox",7),t.ɵɵlistener("ngModelChange",(function(e){return n.legend.max=e})),t.ɵɵelementEnd(),t.ɵɵelementEnd(),t.ɵɵelementStart(12,"div",5),t.ɵɵelementStart(13,"ed-checkbox",8),t.ɵɵlistener("ngModelChange",(function(e){return n.legend.avg=e})),t.ɵɵelementEnd(),t.ɵɵelementStart(14,"ed-checkbox",9),t.ɵɵlistener("ngModelChange",(function(e){return n.legend.current=e})),t.ɵɵelementEnd(),t.ɵɵelementEnd(),t.ɵɵelementStart(15,"div",5),t.ɵɵelementStart(16,"ed-checkbox",10),t.ɵɵlistener("ngModelChange",(function(e){return n.legend.total=e})),t.ɵɵelementEnd(),t.ɵɵelementEnd(),t.ɵɵelementEnd(),t.ɵɵelementStart(17,"div",0),t.ɵɵelementStart(18,"h5",1),t.ɵɵtext(19,"Hide series"),t.ɵɵelementEnd(),t.ɵɵelementStart(20,"ed-checkbox",11),t.ɵɵlistener("ngModelChange",(function(e){return n.legend.hideOnlyNulls=e})),t.ɵɵelementEnd(),t.ɵɵelementStart(21,"ed-checkbox",12),t.ɵɵlistener("ngModelChange",(function(e){return n.legend.hideOnlyZeroes=e})),t.ɵɵelementEnd(),t.ɵɵelementEnd()),2&e&&(t.ɵɵadvance(3),t.ɵɵproperty("ngModel",n.legend.show),t.ɵɵadvance(1),t.ɵɵproperty("ngModel",n.legend.table),t.ɵɵadvance(1),t.ɵɵproperty("ngModel",n.legend.right),t.ɵɵadvance(5),t.ɵɵproperty("ngModel",n.legend.min),t.ɵɵadvance(1),t.ɵɵproperty("ngModel",n.legend.max),t.ɵɵadvance(2),t.ɵɵproperty("ngModel",n.legend.avg),t.ɵɵadvance(1),t.ɵɵproperty("ngModel",n.legend.current),t.ɵɵadvance(2),t.ɵɵproperty("ngModel",n.legend.total),t.ɵɵadvance(4),t.ɵɵproperty("ngModel",n.legend.hideOnlyNulls),t.ɵɵadvance(1),t.ɵɵproperty("ngModel",n.legend.hideOnlyZeroes))},directives:[o.CheckBoxComponent,i.NgControlStatus,i.NgModel],encapsulation:2});var M=function(){function e(e,t,n){var r=this;this.router=e,this.activatedRoute=t,this.location=n,this.index=0,this.activatedRoute.queryParamMap.subscribe((function(e){var t=e.get("tab");Number.isInteger(+t)&&(r.index=+t)}))}return e.prototype.onTabSelected=function(e){var t=this.router.createUrlTree([],{relativeTo:this.activatedRoute,queryParams:{tab:e},queryParamsHandling:"merge"}).toString();this.location.go(t)},e}();M.ɵfac=function(e){return new(e||M)(t.ɵɵdirectiveInject(n.Router),t.ɵɵdirectiveInject(n.ActivatedRoute),t.ɵɵdirectiveInject(r.Location))},M.ɵcmp=t.ɵɵdefineComponent({type:M,selectors:[["widget-editor"]],decls:15,vars:1,consts:[["header","Graph",3,"ngModel","ngModelChange","selected"],["header","General"],["edTabContent",""],["header","Metrics"],["header","Axes"],["header","Legend"],["header","Display"],["header","Alert"],["header","Time range"]],template:function(e,n){1&e&&(t.ɵɵelementStart(0,"ed-tabstrip",0),t.ɵɵlistener("ngModelChange",(function(e){return n.index=e}))("selected",(function(e){return n.onTabSelected(e)})),t.ɵɵelementStart(1,"ed-tab",1),t.ɵɵtemplate(2,h,1,0,"ng-template",2),t.ɵɵelementEnd(),t.ɵɵelementStart(3,"ed-tab",3),t.ɵɵtemplate(4,f,1,0,"ng-template",2),t.ɵɵelementEnd(),t.ɵɵelementStart(5,"ed-tab",4),t.ɵɵtemplate(6,m,1,0,"ng-template",2),t.ɵɵelementEnd(),t.ɵɵelementStart(7,"ed-tab",5),t.ɵɵtemplate(8,v,1,0,"ng-template",2),t.ɵɵelementEnd(),t.ɵɵelementStart(9,"ed-tab",6),t.ɵɵtemplate(10,y,1,0,"ng-template",2),t.ɵɵelementEnd(),t.ɵɵelementStart(11,"ed-tab",7),t.ɵɵtemplate(12,b,1,0,"ng-template",2),t.ɵɵelementEnd(),t.ɵɵelementStart(13,"ed-tab",8),t.ɵɵtemplate(14,C,1,0,"ng-template",2),t.ɵɵelementEnd(),t.ɵɵelementEnd()),2&e&&t.ɵɵproperty("ngModel",n.index)},directives:[o.TabStripComponent,i.NgControlStatus,i.NgModel,o.TabComponent,o.TabContentTemplate,d,c,p,g],encapsulation:2});!function(){function e(){}e.alignPixel=function(e,t,n){var r=e.currentDevicePixelRatio,o=n/2;return Math.round((t-o)*r)/r+o}}();var S=function(){function e(){}return Object.defineProperty(e.prototype,"id",{get:function(){return e.ID},enumerable:!1,configurable:!0}),e.prototype.afterDatasetsDraw=function(e,t){},e.prototype.getMousePos=function(e,t){if(t){var n=e.getBoundingClientRect();return{x:t.clientX-n.left,y:t.clientY-n.top}}},e}();S.ID="trackball";function E(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a}function x(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(E(arguments[t]));return e}var D=function(){function e(){}return e.getColor=function(e){var t=this.palette[e.index%this.palette.length];return this.hexToRgb(t)},e.getColorAsArgbFunc=function(e,t){void 0===t&&(t=1);var n=this.getColor(e);return"rgba("+n.r+","+n.g+","+n.b+", "+t+")"},e.hexToRgb=function(e){var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:null},e.parse=function(e){var t=[];if("#"==e.substr(0,1)){var n=(e.length-1)/3,r=[17,1,.062272][n-1];t=[Math.round(parseInt(e.substr(1,n),16)*r),Math.round(parseInt(e.substr(1+n,n),16)*r),Math.round(parseInt(e.substr(1+2*n,n),16)*r)]}else t=e.split("(")[1].split(")")[0].split(",").map(Math.round);return{r:t[0],g:t[1],b:t[2]}},e.rgbToHex=function(t){var n=e.parse(t);return"#"+n.r.toString(16).padStart(2,"0")+n.g.toString(16).padStart(2,"0")+n.b.toString(16).padStart(2,"0")},e}();D.palette=["7eb26d","cca300","6ed0e0","EF843C","E24D42","1F78C1","BA43A9","705DA0","508642","CCA300","447EBC","C15C17","890F02","0A437C","6D1F62","584477","B7DBAB","F4D598","70DBED","F9BA8F","F29191","82B5D8","E5A8E2","AEA2E0","629E51","E5AC0E","64B0C8","E0752D","BF1B00","0A50A1","962D82","614D93","9AC48A","F2C96D","65C5DB","F9934E","5195CE","D683CE","806EB7","3F6833","967302","2F575E","99440A","58140C","052B51","511749","3F2B5B","E0F9D7","FCEACA","CFFAFF","F9E2D2","FCE2DE","BADFF4","F9D9F9","DEDAF7","EA6460"];var F=function(){function e(e){this.panel=e}return Object.defineProperty(e.prototype,"display",{get:function(){return this.panel.widget.display},enumerable:!1,configurable:!0}),e.prototype.setup=function(e){this.setupLines(e),this.setupPoints(e),this.setupNullValue(e)},e.prototype.setupLines=function(e){var t=this.getShowLines(e),n=this.getLineWidth(e),r=this.getFill(e),o=r/10;if(e.fill=r>0,e.backgroundColor=this.getLineColor(e,o),o=t&&n?1:0,e.borderColor=this.getLineColor(e,o),e.borderWidth=n,e.steppedLine=this.getStaircase(e),this.getDashes(e)){var i=this.getDashLength(e),a=this.getDashSpace(e);e.borderDash=[i,a]}else e.borderDash=void 0;e.order=this.getZIndex(e),e.legend=this.getLegend(e)},e.prototype.setupPoints=function(e){var t=this.getShowPoints(e),n=t?1:0,r=this.getLineColor(e,n);e.pointBorderColor=""+r,e.pointBackgroundColor=""+r,e.pointRadius=t?this.getPointRadius(e):0},e.prototype.setupNullValue=function(e){parseInt(this.display.nullValue)},e.prototype.setupOverrides=function(){},e.prototype.getShowLines=function(e){var t=this.getOverride(e);return t&&null!=t.lines?t.lines:this.display.showLines},e.prototype.getLineWidth=function(e){var t=this.getOverride(e);return t&&null!=t.lineWidth?t.lineWidth:this.display.lineWidth},e.prototype.getLineColor=function(e,t){var n,r=this.getOverride(e),o=D.getColorAsArgbFunc(e,t),i=r&&null!=r.color;if(i){var a=D.parse(r.color);n="rgba("+a.r+","+a.g+","+a.b+","+t+")"}return i?n:o},e.prototype.getFill=function(e){var t=this.getOverride(e);return t&&null!=t.lineFill?t.lineFill:this.display.fill},e.prototype.getStaircase=function(e){var t=this.getOverride(e);return t&&null!=t.staircase?t.staircase:this.display.staircase},e.prototype.getDashes=function(e){var t=this.getOverride(e);return!(!t||null==t.dashes)&&t.dashes},e.prototype.getDashLength=function(e){var t=this.getOverride(e);return t&&null!=t.dashLength?t.dashLength:1},e.prototype.getDashSpace=function(e){var t=this.getOverride(e);return t&&null!=t.dashSpace?t.dashSpace:1},e.prototype.getShowPoints=function(e){var t=this.getOverride(e);return t&&null!=t.points?t.points:this.display.showPoints},e.prototype.getPointRadius=function(e){var t=this.getOverride(e);return t&&null!=t.pointRadius?t.pointRadius:this.display.pointRadius},e.prototype.getLegend=function(e){var t=this.getOverride(e);return!t||null==t.legend||t.legend},e.prototype.getZIndex=function(e){var t=this.getOverride(e);return t&&null!=t.zIndex?t.zIndex:0},e.prototype.getYAxis=function(e){var t=this.getOverride(e);return t&&null!=t.yAxis?t.yAxis:1},e.prototype.getOverride=function(e){return this.display.overrides.find((function(t){return t.alias&&new RegExp(t.alias).test(e.label)}))},e}();F.ɵfac=function(e){return new(e||F)(t.ɵɵinject(s))},F.ɵprov=t.ɵɵdefineInjectable({token:F,factory:F.ɵfac});var A=function(){function e(e){this.dispay=e}return e.prototype.toDataSets=function(e){var t=this;if(!e||0===e.length)return[];var n=[],r=0;return e.forEach((function(e){var o=x(e.columns.slice(1).map((function(n,o){return t.toDataSet(e,o+1,r++)}))).filter((function(e){return e}));(n=x(n,o)).forEach((function(e){return t.dispay.setup(e)}))})),n},e.prototype.toDataSet=function(e,t,n){var r=e.values.map((function(e){var n=null==e[t];return{x:a.Moment.valueOf(e[0]),y:e[t],isNull:n}})),o=r.map((function(e){return e.y})).filter((function(e){return null!=e})).map((function(e){return parseFloat(e)}));if(0!=o.length){var i=o.reduce((function(e,t){return e+t}))/o.length,l=o.every((function(e){return null==e})),u=o.every((function(e){return 0==e}));return{label:this.generateDataSetName(e,t),data:r,lineTension:0,min:Math.min.apply(Math,x(o)),max:Math.max.apply(Math,x(o)),avg:i,current:o.slice(-1)[0],allNulls:l,allZeros:u,index:n,pointRadius:0,borderColor:"#ff0000"}}},e.prototype.generateDataSetName=function(e,t){var n=e.name+"."+e.columns[t],r="",o=(Object.keys(e.tags),0);for(var i in e.tags)r+=(o>0?", ":"")+i+": "+e.tags[i],o++;return r&&(n=n+" {"+r+"}"),n},e}();A.ɵfac=function(e){return new(e||A)(t.ɵɵinject(F))},A.ɵprov=t.ɵɵdefineInjectable({token:A,factory:A.ɵfac});var O=function(){function e(e,n,r,o,i){var a=this;this.pluginActivator=e,this.dsService=n,this.converter=r,this.time=o,this.panel=i,this.data$=new t.EventEmitter,this.timeSubs=this.time.range$.pipe(u.tap((function(e){return a.request=""})),u.mergeMap((function(e){return a.pluginActivator.createDataSourceMetricsBuilder(i)})),u.mergeMap((function(e){return e.build(a.metrics,o.range)}))).subscribe((function(e){return a.pull(e)}))}return Object.defineProperty(e.prototype,"metrics",{get:function(){var e,t;return null===(t=null===(e=this.panel)||void 0===e?void 0:e.widget)||void 0===t?void 0:t.metrics},enumerable:!1,configurable:!0}),e.prototype.destroy=function(){var e;null===(e=this.timeSubs)||void 0===e||e.unsubscribe()},e.prototype.pull=function(e){var t=this;this.request!==e&&(this.request=e,console.log("pull: "+e),e?(this.panel.loading=!0,this.dsService.proxy(6,e).pipe(u.finalize((function(){return t.panel.loading=!1}))).subscribe((function(e){return t.onData(e)}),(function(e){return t.onError(e.error)}))):this.onData([]))},e.prototype.onData=function(e){this.data$.emit({datasets:this.converter.toDataSets(e)})},e.prototype.onError=function(e){},e}();O.ɵfac=function(e){return new(e||O)(t.ɵɵinject(a.PluginActivator),t.ɵɵinject(a.DataSourceService),t.ɵɵinject(A),t.ɵɵinject(a.TimeRangeStore),t.ɵɵinject(s))},O.ɵprov=t.ɵɵdefineInjectable({token:O,factory:O.ɵfac});var w=function(){function e(){}return e.getOptions=function(){Chart.defaults.global.defaultFontColor="#e3e3e3",Chart.defaults.global.defaultFontFamily="Roboto",Chart.defaults.global.defaultFontSize=11;var e={id:"A",gridLines:{color:"rgba( 255,255,255, 0.1)",zeroLineWidth:3}};return{maintainAspectRatio:!1,animation:!1,legend:{display:!1},spanGaps:!0,scales:{xAxes:[{type:"time",gridLines:{color:"rgba( 255,255,255, 0.1)"},ticks:{autoSkip:!0,autoSkipPadding:50,maxRotation:0,minRotation:0},time:{displayFormats:{second:"HH:mm:ss",minute:"HH:mm",hour:"HH:mm",day:"M/D HH:mm",week:"M/D",month:"M/D",year:"YYYY-M"}}}],yAxes:[e]}}},e}(),I=function(){function e(e){var t=this;this.dataProvider=e,this.plugins=[new S],this.dataProvider.data$.subscribe((function(e){return t.data=e})),this.options=w.getOptions()}return e.prototype.ngOnDestroy=function(){this.dataProvider.destroy()},e}();I.ɵfac=function(e){return new(e||I)(t.ɵɵdirectiveInject(O))},I.ɵcmp=t.ɵɵdefineComponent({type:I,selectors:[["widget"]],features:[t.ɵɵProvidersFeature([O,A,F])],decls:1,vars:3,consts:[["type","line","height","100%",3,"data","options","plugins"]],template:function(e,n){1&e&&t.ɵɵelement(0,"p-chart",0),2&e&&t.ɵɵproperty("data",n.data)("options",n.options)("plugins",n.plugins)},directives:[l.UIChart],encapsulation:2});var j=function(){};j.ɵmod=t.ɵɵdefineNgModule({type:j}),j.ɵinj=t.ɵɵdefineInjector({factory:function(e){return new(e||j)},imports:[[r.CommonModule,i.FormsModule,i.ReactiveFormsModule,l.ChartModule,a.EdCommonModule,o.EdUilibModule]]}),("undefined"==typeof ngJitMode||ngJitMode)&&t.ɵɵsetNgModuleScope(j,{declarations:[I,M,d,c,p,g],imports:[r.CommonModule,i.FormsModule,i.ReactiveFormsModule,l.ChartModule,a.EdCommonModule,o.EdUilibModule],exports:[I,M]}),e.ChartComponent=I,e.ChartEditorComponent=M,e.ChartWidgetModule=j,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=chart.umd.min.js.map