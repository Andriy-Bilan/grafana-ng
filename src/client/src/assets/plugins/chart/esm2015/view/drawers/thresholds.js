import { Injectable } from '@angular/core';
import { BaseDrawer, ChartJsExtension } from '../../base/chart-base-extension';
import { AXIS_X, AXIS_Y_LEFT, AXIS_Y_RIGHT, ThresholdAxis, ThresholdColor, ThresholdOperator } from '../../chart.m';
import * as i0 from "@angular/core";
import * as i1 from "../../base/chart.store";
export class ThresholdDrawerPlugin extends ChartJsExtension {
    constructor(store) {
        super(store);
    }
    afterDatasetsDraw(chart, _) {
        var _a, _b;
        (_b = (_a = this
            .widget) === null || _a === void 0 ? void 0 : _a.display) === null || _b === void 0 ? void 0 : _b.thresholds.forEach(t => new ThresholdDrawer(chart, t).draw());
    }
}
ThresholdDrawerPlugin.ɵfac = function ThresholdDrawerPlugin_Factory(t) { return new (t || ThresholdDrawerPlugin)(i0.ɵɵinject(i1.ChartStore)); };
ThresholdDrawerPlugin.ɵprov = i0.ɵɵdefineInjectable({ token: ThresholdDrawerPlugin, factory: ThresholdDrawerPlugin.ɵfac });
/*@__PURE__*/ (function () { i0.ɵsetClassMetadata(ThresholdDrawerPlugin, [{
        type: Injectable
    }], function () { return [{ type: i1.ChartStore }]; }, null); })();
class ThresholdDrawer extends BaseDrawer {
    constructor(chart, threshold) {
        super(chart);
        this.threshold = threshold;
    }
    draw() {
        if (this.threshold.value == undefined) {
            return;
        }
        const scaleYA = this.chart.scales[AXIS_Y_LEFT];
        const scaleYB = this.chart.scales[AXIS_Y_RIGHT];
        const scaleX = this.chart.scales[AXIS_X];
        const scaleY = (this.threshold.axis == ThresholdAxis.Right && scaleYB) ?
            scaleYB : scaleYA;
        const offset = scaleY.getPixelForValue(this.threshold.value);
        const gt = (this.threshold.operator == ThresholdOperator.Gt);
        const shouldIgnore = (!gt && this.threshold.value < scaleY.min) ||
            (gt && this.threshold.value > scaleY.max) ||
            (!this.chart.data.datasets.length);
        if (shouldIgnore) {
            return;
        }
        // if( offset < 0 || offset > scaleY.bottom ){
        // 	return;
        // }
        //console.log( `${offset} | ${scaleY.bottom}` )  
        if (this.threshold.line) {
            const lineColor = this.getColor(false);
            this.renderLine(scaleX, lineColor, offset);
        }
        if (this.threshold.fill) {
            this.renderRectangle(scaleX, scaleY, offset);
        }
    }
    renderLine(scaleX, color, offset) {
        this.context.beginPath();
        this.context.strokeStyle = color + "99";
        this.context.lineWidth = 2;
        this.context.moveTo(scaleX.left, offset);
        this.context.lineTo(scaleX.right, offset);
        this.context.stroke();
    }
    renderRectangle(scaleX, scaleY, offset) {
        const color = this.getColor(true);
        const gt = (this.threshold.operator == ThresholdOperator.Gt);
        this.context.fillStyle = color + "22";
        const x = scaleX.left;
        const w = scaleX.width;
        const topY = scaleY.getPixelForValue(scaleY.max);
        const bottomY = scaleY.getPixelForValue(scaleY.min);
        const y = gt ? topY : Math.max(topY, offset);
        let h = gt ? offset - scaleY.top : scaleY.bottom - offset;
        h = Math.min(bottomY - topY, h);
        this.context.fillRect(x, y, w, h);
    }
    getColor(fill) {
        switch (this.threshold.colorType) {
            case ThresholdColor.Critical:
                return '#ED2E18';
            case ThresholdColor.Ok:
                return '#10a345';
            case ThresholdColor.Warning:
                return '#f79520';
        }
        const defaultColor = '#ffffff';
        if (fill) {
            return this.threshold.fillColor ? this.threshold.fillColor : defaultColor;
        }
        return this.threshold.lineColor ? this.threshold.lineColor : defaultColor;
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidGhyZXNob2xkcy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uL2FwcC9wbHVnaW5zL3dpZGdldHMvY2hhcnQvc3JjL3ZpZXcvZHJhd2Vycy90aHJlc2hvbGRzLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSxVQUFVLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFDM0MsT0FBTyxFQUFFLFVBQVUsRUFBRSxnQkFBZ0IsRUFBRSxNQUFNLGlDQUFpQyxDQUFDO0FBRS9FLE9BQU8sRUFBRSxNQUFNLEVBQUUsV0FBVyxFQUFFLFlBQVksRUFDekMsYUFBYSxFQUFFLGNBQWMsRUFBRSxpQkFBaUIsRUFBRSxNQUFNLGVBQWUsQ0FBQzs7O0FBR3pFLE1BQU0sT0FBTyxxQkFBc0IsU0FBUSxnQkFBZ0I7SUFFMUQsWUFBYSxLQUFpQjtRQUM3QixLQUFLLENBQUUsS0FBSyxDQUFFLENBQUM7SUFDaEIsQ0FBQztJQUVELGlCQUFpQixDQUFDLEtBQUssRUFBRSxDQUFDOztRQUN6QixZQUFBLElBQUk7YUFDRixNQUFNLDBDQUNMLE9BQU8sMENBQ1AsVUFBVSxDQUNYLE9BQU8sQ0FBRSxDQUFDLENBQUMsRUFBRSxDQUFDLElBQUksZUFBZSxDQUFFLEtBQUssRUFBRSxDQUFDLENBQUUsQ0FBQyxJQUFJLEVBQUUsRUFBRztJQUMxRCxDQUFDOzswRkFaVyxxQkFBcUI7NkRBQXJCLHFCQUFxQixXQUFyQixxQkFBcUI7a0RBQXJCLHFCQUFxQjtjQURqQyxVQUFVOztBQWdCWCxNQUFNLGVBQWdCLFNBQVEsVUFBVTtJQUV2QyxZQUFhLEtBQVUsRUFBVSxTQUFvQjtRQUNwRCxLQUFLLENBQUUsS0FBSyxDQUFFLENBQUM7UUFEaUIsY0FBUyxHQUFULFNBQVMsQ0FBVztJQUVyRCxDQUFDO0lBRUQsSUFBSTtRQUNILElBQUksSUFBSSxDQUFDLFNBQVMsQ0FBQyxLQUFLLElBQUksU0FBUyxFQUFFO1lBQ3RDLE9BQU87U0FDUDtRQUVE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LENBQUMsQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUMsWUFBWSxDQUFDO0lBQzNFLENBQUM7Q0FDRCIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEluamVjdGFibGUgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgQmFzZURyYXdlciwgQ2hhcnRKc0V4dGVuc2lvbiB9IGZyb20gJy4uLy4uL2Jhc2UvY2hhcnQtYmFzZS1leHRlbnNpb24nO1xyXG5pbXBvcnQgeyBDaGFydFN0b3JlIH0gZnJvbSAnLi4vLi4vYmFzZS9jaGFydC5zdG9yZSc7XHJcbmltcG9ydCB7IEFYSVNfWCwgQVhJU19ZX0xFRlQsIEFYSVNfWV9SSUdIVCwgVGhyZXNob2xkLFxyXG5cdFRocmVzaG9sZEF4aXMsIFRocmVzaG9sZENvbG9yLCBUaHJlc2hvbGRPcGVyYXRvciB9IGZyb20gJy4uLy4uL2NoYXJ0Lm0nO1xyXG5cclxuQEluamVjdGFibGUoKVxyXG5leHBvcnQgY2xhc3MgVGhyZXNob2xkRHJhd2VyUGx1Z2luIGV4dGVuZHMgQ2hhcnRKc0V4dGVuc2lvbiB7XHJcblx0XHJcblx0Y29uc3RydWN0b3IoIHN0b3JlOiBDaGFydFN0b3JlICl7XHJcblx0XHRzdXBlciggc3RvcmUgKTtcclxuXHR9XHJcblxyXG5cdGFmdGVyRGF0YXNldHNEcmF3KGNoYXJ0LCBfKSB7XHJcblx0XHR0aGlzXHJcblx0XHRcdC53aWRnZXRcclxuXHRcdFx0Py5kaXNwbGF5XHJcblx0XHRcdD8udGhyZXNob2xkc1xyXG5cdFx0XHQuZm9yRWFjaCggdCA9PiBuZXcgVGhyZXNob2xkRHJhd2VyKCBjaGFydCwgdCApLmRyYXcoKSApO1xyXG5cdH1cclxufVxyXG5cclxuY2xhc3MgVGhyZXNob2xkRHJhd2VyIGV4dGVuZHMgQmFzZURyYXdlcntcclxuXHRcclxuXHRjb25zdHJ1Y3RvciggY2hhcnQ6IGFueSwgcHJpdmF0ZSB0aHJlc2hvbGQ6IFRocmVzaG9sZCApe1xyXG5cdFx0c3VwZXIoIGNoYXJ0ICk7XHJcblx0fVxyXG5cclxuXHRkcmF3KCl7XHJcblx0XHRpZiggdGhpcy50aHJlc2hvbGQudmFsdWUgPT0gdW5kZWZpbmVkICl7XHJcblx0XHRcdHJldHVybjtcclxuXHRcdH1cclxuXHJcblx0XHRjb25zdCBzY2FsZVlBID0gdGhpcy5jaGFydC5zY2FsZXNbIEFYSVNfWV9MRUZUIF07XHJcblx0XHRjb25zdCBzY2FsZVlCID0gdGhpcy5jaGFydC5zY2FsZXNbIEFYSVNfWV9SSUdIVCBdO1xyXG5cdFx0Y29uc3Qgc2NhbGVYID0gdGhpcy5jaGFydC5zY2FsZXNbIEFYSVNfWCBdO1xyXG5cclxuXHRcdGNvbnN0IHNjYWxlWSA9ICggdGhpcy50aHJlc2hvbGQuYXhpcyA9PSBUaHJlc2hvbGRBeGlzLlJpZ2h0ICYmIHNjYWxlWUIgKSA/XHJcblx0XHRcdHNjYWxlWUIgOiBzY2FsZVlBO1xyXG5cclxuXHRcdGNvbnN0IG9mZnNldCA9IHNjYWxlWS5nZXRQaXhlbEZvclZhbHVlKHRoaXMudGhyZXNob2xkLnZhbHVlKTtcclxuXHJcblx0XHRjb25zdCBndCA9ICggdGhpcy50aHJlc2hvbGQub3BlcmF0b3IgPT0gVGhyZXNob2xkT3BlcmF0b3IuR3QgKTtcclxuXHJcblx0XHRjb25zdCBzaG91bGRJZ25vcmUgPSBcclxuXHRcdFx0KCAhZ3QgJiYgdGhpcy50aHJlc2hvbGQudmFsdWUgPCBzY2FsZVkubWluICkgfHxcclxuXHRcdFx0KCBndCAmJiB0aGlzLnRocmVzaG9sZC52YWx1ZSA+IHNjYWxlWS5tYXggKSB8fFxyXG5cdFx0XHQoICF0aGlzLmNoYXJ0LmRhdGEuZGF0YXNldHMubGVuZ3RoICk7XHJcblxyXG5cdFx0aWYoIHNob3VsZElnbm9yZSApe1xyXG5cdFx0XHRyZXR1cm47XHJcblx0XHR9XHJcblxyXG5cdFx0Ly8gaWYoIG9mZnNldCA8IDAgfHwgb2Zmc2V0ID4gc2NhbGVZLmJvdHRvbSApe1xyXG5cdFx0Ly8gXHRyZXR1cm47XHJcblx0XHQvLyB9XHJcblxyXG5cdFx0Ly9jb25zb2xlLmxvZyggYCR7b2Zmc2V0fSB8ICR7c2NhbGVZLmJvdHRvbX1gICkgIFxyXG5cclxuXHRcdGlmKCB0aGlzLnRocmVzaG9sZC5saW5lICl7XHJcblx0XHRcdGNvbnN0IGxpbmVDb2xvciA9IHRoaXMuZ2V0Q29sb3IoIGZhbHNlICk7XHJcblx0XHRcdHRoaXMucmVuZGVyTGluZSggc2NhbGVYLCBsaW5lQ29sb3IsIG9mZnNldCApO1xyXG5cdFx0fVxyXG5cclxuXHRcdGlmKCB0aGlzLnRocmVzaG9sZC5maWxsICl7XHJcblx0XHRcdHRoaXMucmVuZGVyUmVjdGFuZ2xlKCBzY2FsZVgsIHNjYWxlWSwgb2Zmc2V0ICk7XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHRwcml2YXRlIHJlbmRlckxpbmUoc2NhbGVYLCBjb2xvciwgb2Zmc2V0ICl7XHJcblx0XHR0aGlzLmNvbnRleHQuYmVnaW5QYXRoKCk7XHJcblx0XHR0aGlzLmNvbnRleHQuc3Ryb2tlU3R5bGUgPSBjb2xvciArIFwiOTlcIjtcclxuXHRcdHRoaXMuY29udGV4dC5saW5lV2lkdGggPSAyO1xyXG5cdFx0dGhpcy5jb250ZXh0Lm1vdmVUbyggc2NhbGVYLmxlZnQsIG9mZnNldCk7XHJcblx0XHR0aGlzLmNvbnRleHQubGluZVRvKCBzY2FsZVgucmlnaHQsIG9mZnNldCk7XHJcblx0XHR0aGlzLmNvbnRleHQuc3Ryb2tlKCk7XHJcblx0fVxyXG5cclxuXHRwcml2YXRlIHJlbmRlclJlY3RhbmdsZSggc2NhbGVYLCBzY2FsZVksIG9mZnNldCApe1xyXG5cdFx0Y29uc3QgY29sb3IgPSB0aGlzLmdldENvbG9yKCB0cnVlICk7XHJcblxyXG5cdFx0Y29uc3QgZ3QgPSAoIHRoaXMudGhyZXNob2xkLm9wZXJhdG9yID09IFRocmVzaG9sZE9wZXJhdG9yLkd0ICk7XHJcblx0XHR0aGlzLmNvbnRleHQuZmlsbFN0eWxlID0gY29sb3IgKyBcIjIyXCJcclxuXHJcblx0XHRjb25zdCB4ID0gc2NhbGVYLmxlZnQ7XHJcblx0XHRjb25zdCB3ID0gc2NhbGVYLndpZHRoO1xyXG5cclxuXHRcdGNvbnN0IHRvcFkgPSBzY2FsZVkuZ2V0UGl4ZWxGb3JWYWx1ZShzY2FsZVkubWF4KTtcclxuXHRcdGNvbnN0IGJvdHRvbVkgPSBzY2FsZVkuZ2V0UGl4ZWxGb3JWYWx1ZShzY2FsZVkubWluKTtcclxuXHJcblx0XHRjb25zdCB5ID0gZ3QgPyB0b3BZIDogTWF0aC5tYXgoIHRvcFksIG9mZnNldCApO1xyXG5cdFx0bGV0IGggPSBndCA/IG9mZnNldCAtIHNjYWxlWS50b3AgOiBzY2FsZVkuYm90dG9tIC0gb2Zmc2V0O1xyXG5cclxuXHRcdGggPSBNYXRoLm1pbiggYm90dG9tWSAtIHRvcFksIGggKVxyXG5cclxuXHRcdHRoaXMuY29udGV4dC5maWxsUmVjdCggeCwgeSxcdHcsIGggKTtcdFxyXG5cdH1cclxuXHJcblx0cHJpdmF0ZSBnZXRDb2xvcihmaWxsKXtcclxuXHRcdHN3aXRjaCggdGhpcy50aHJlc2hvbGQuY29sb3JUeXBlICl7XHJcblx0XHRcdGNhc2UgVGhyZXNob2xkQ29sb3IuQ3JpdGljYWw6XHJcblx0XHRcdFx0cmV0dXJuICcjRUQyRTE4JztcclxuXHJcblx0XHRcdGNhc2UgVGhyZXNob2xkQ29sb3IuT2s6XHJcblx0XHRcdFx0cmV0dXJuICcjMTBhMzQ1JztcclxuXHJcblx0XHRcdGNhc2UgVGhyZXNob2xkQ29sb3IuV2FybmluZzpcclxuXHRcdFx0XHRyZXR1cm4gJyNmNzk1MjAnO1xyXG5cdFx0fVxyXG5cclxuXHRcdGNvbnN0IGRlZmF1bHRDb2xvciA9ICcjZmZmZmZmJztcclxuXHJcblx0XHRpZiggZmlsbCApe1xyXG5cdFx0XHRyZXR1cm4gdGhpcy50aHJlc2hvbGQuZmlsbENvbG9yID8gdGhpcy50aHJlc2hvbGQuZmlsbENvbG9yIDogZGVmYXVsdENvbG9yO1xyXG5cdFx0fVxyXG5cclxuXHRcdHJldHVybiB0aGlzLnRocmVzaG9sZC5saW5lQ29sb3IgPyB0aGlzLnRocmVzaG9sZC5saW5lQ29sb3IgOiBkZWZhdWx0Q29sb3I7XHJcblx0fVxyXG59Il19