import { Injectable } from '@angular/core';
import { BaseDrawer, ChartJsExtension } from '../../base/chart-base-extension';
import { AXIS_X, AXIS_Y_LEFT, AXIS_Y_RIGHT, ThresholdAxis, ThresholdColor, ThresholdOperator } from '../../chart.m';
import * as i0 from "@angular/core";
import * as i1 from "../../base/chart.store";
export class ThresholdDrawerPlugin extends ChartJsExtension {
    constructor(store) {
        super(store);
    }
    afterDatasetsDraw(chart, _) {
        var _a, _b, _c;
        (_c = (_b = (_a = this
            .widget) === null || _a === void 0 ? void 0 : _a.display) === null || _b === void 0 ? void 0 : _b.thresholds) === null || _c === void 0 ? void 0 : _c.forEach(t => new ThresholdDrawer(chart, t).draw());
    }
}
ThresholdDrawerPlugin.ɵfac = function ThresholdDrawerPlugin_Factory(t) { return new (t || ThresholdDrawerPlugin)(i0.ɵɵinject(i1.ChartStore)); };
ThresholdDrawerPlugin.ɵprov = i0.ɵɵdefineInjectable({ token: ThresholdDrawerPlugin, factory: ThresholdDrawerPlugin.ɵfac });
/*@__PURE__*/ (function () { i0.ɵsetClassMetadata(ThresholdDrawerPlugin, [{
        type: Injectable
    }], function () { return [{ type: i1.ChartStore }]; }, null); })();
class ThresholdDrawer extends BaseDrawer {
    constructor(chart, threshold) {
        super(chart);
        this.threshold = threshold;
    }
    draw() {
        if (this.threshold.value == undefined) {
            return;
        }
        const scaleYA = this.chart.scales[AXIS_Y_LEFT];
        const scaleYB = this.chart.scales[AXIS_Y_RIGHT];
        const scaleX = this.chart.scales[AXIS_X];
        const scaleY = (this.threshold.axis == ThresholdAxis.Right && scaleYB) ?
            scaleYB : scaleYA;
        const offset = scaleY.getPixelForValue(this.threshold.value);
        const gt = (this.threshold.operator == ThresholdOperator.Gt);
        const shouldIgnore = (!gt && this.threshold.value < scaleY.min) ||
            (gt && this.threshold.value > scaleY.max) ||
            (!this.chart.data.datasets.length);
        if (shouldIgnore) {
            return;
        }
        // if( offset < 0 || offset > scaleY.bottom ){
        // 	return;
        // }
        //console.log( `${offset} | ${scaleY.bottom}` )  
        if (this.threshold.line) {
            const lineColor = this.getColor(false);
            this.renderLine(scaleX, lineColor, offset);
        }
        if (this.threshold.fill) {
            this.renderRectangle(scaleX, scaleY, offset);
        }
    }
    renderLine(scaleX, color, offset) {
        this.context.beginPath();
        this.context.strokeStyle = color + "99";
        this.context.lineWidth = 2;
        this.context.moveTo(scaleX.left, offset);
        this.context.lineTo(scaleX.right, offset);
        this.context.stroke();
    }
    renderRectangle(scaleX, scaleY, offset) {
        const color = this.getColor(true);
        const gt = (this.threshold.operator == ThresholdOperator.Gt);
        this.context.fillStyle = color + "22";
        const x = scaleX.left;
        const w = scaleX.width;
        const topY = scaleY.getPixelForValue(scaleY.max);
        const bottomY = scaleY.getPixelForValue(scaleY.min);
        const y = gt ? topY : Math.max(topY, offset);
        let h = gt ? offset - scaleY.top : scaleY.bottom - offset;
        h = Math.min(bottomY - topY, h);
        this.context.fillRect(x, y, w, h);
    }
    getColor(fill) {
        switch (this.threshold.colorType) {
            case ThresholdColor.Critical:
                return '#ED2E18';
            case ThresholdColor.Ok:
                return '#10a345';
            case ThresholdColor.Warning:
                return '#f79520';
        }
        const defaultColor = '#ffffff';
        if (fill) {
            return this.threshold.fillColor ? this.threshold.fillColor : defaultColor;
        }
        return this.threshold.lineColor ? this.threshold.lineColor : defaultColor;
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidGhyZXNob2xkcy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uL2FwcC9wbHVnaW5zL3dpZGdldHMvY2hhcnQvc3JjL3ZpZXcvZHJhd2Vycy90aHJlc2hvbGRzLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSxVQUFVLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFDM0MsT0FBTyxFQUFFLFVBQVUsRUFBRSxnQkFBZ0IsRUFBRSxNQUFNLGlDQUFpQyxDQUFDO0FBRS9FLE9BQU8sRUFBRSxNQUFNLEVBQUUsV0FBVyxFQUFFLFlBQVksRUFDekMsYUFBYSxFQUFFLGNBQWMsRUFBRSxpQkFBaUIsRUFBRSxNQUFNLGVBQWUsQ0FBQzs7O0FBR3pFLE1BQU0sT0FBTyxxQkFBc0IsU0FBUSxnQkFBZ0I7SUFFMUQsWUFBYSxLQUFpQjtRQUM3QixLQUFLLENBQUUsS0FBSyxDQUFFLENBQUM7SUFDaEIsQ0FBQztJQUVELGlCQUFpQixDQUFDLEtBQUssRUFBRSxDQUFDOztRQUN6QixrQkFBQSxJQUFJO2FBQ0YsTUFBTSwwQ0FDTCxPQUFPLDBDQUNQLFVBQVUsMENBQ1YsT0FBTyxDQUFFLENBQUMsQ0FBQyxFQUFFLENBQUMsSUFBSSxlQUFlLENBQUUsS0FBSyxFQUFFLENBQUMsQ0FBRSxDQUFDLElBQUksRUFBRSxFQUFHO0lBQzNELENBQUM7OzBGQVpXLHFCQUFxQjs2REFBckIscUJBQXFCLFdBQXJCLHFCQUFxQjtrREFBckIscUJBQXFCO2NBRGpDLFVBQVU7O0FBZ0JYLE1BQU0sZUFBZ0IsU0FBUSxVQUFVO0lBRXZDLFlBQWEsS0FBVSxFQUFVLFNBQW9CO1FBQ3BELEtBQUssQ0FBRSxLQUFLLENBQUUsQ0FBQztRQURpQixjQUFTLEdBQVQsU0FBUyxDQUFXO0lBRXJELENBQUM7SUFFRCxJQUFJO1FBQ0gsSUFBSSxJQUFJLENBQUMsU0FBUyxDQUFDLEtBQUssSUFBSSxTQUFTLEVBQUU7WUFDdEMsT0FBTztTQUNQO1FB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QUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxTQUFTLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQyxZQUFZLENBQUM7SUFDM0UsQ0FBQztDQUNEIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgSW5qZWN0YWJsZSB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBCYXNlRHJhd2VyLCBDaGFydEpzRXh0ZW5zaW9uIH0gZnJvbSAnLi4vLi4vYmFzZS9jaGFydC1iYXNlLWV4dGVuc2lvbic7XHJcbmltcG9ydCB7IENoYXJ0U3RvcmUgfSBmcm9tICcuLi8uLi9iYXNlL2NoYXJ0LnN0b3JlJztcclxuaW1wb3J0IHsgQVhJU19YLCBBWElTX1lfTEVGVCwgQVhJU19ZX1JJR0hULCBUaHJlc2hvbGQsXHJcblx0VGhyZXNob2xkQXhpcywgVGhyZXNob2xkQ29sb3IsIFRocmVzaG9sZE9wZXJhdG9yIH0gZnJvbSAnLi4vLi4vY2hhcnQubSc7XHJcblxyXG5ASW5qZWN0YWJsZSgpXHJcbmV4cG9ydCBjbGFzcyBUaHJlc2hvbGREcmF3ZXJQbHVnaW4gZXh0ZW5kcyBDaGFydEpzRXh0ZW5zaW9uIHtcclxuXHRcclxuXHRjb25zdHJ1Y3Rvciggc3RvcmU6IENoYXJ0U3RvcmUgKXtcclxuXHRcdHN1cGVyKCBzdG9yZSApO1xyXG5cdH1cclxuXHJcblx0YWZ0ZXJEYXRhc2V0c0RyYXcoY2hhcnQsIF8pIHtcclxuXHRcdHRoaXNcclxuXHRcdFx0LndpZGdldFxyXG5cdFx0XHQ/LmRpc3BsYXlcclxuXHRcdFx0Py50aHJlc2hvbGRzXHJcblx0XHRcdD8uZm9yRWFjaCggdCA9PiBuZXcgVGhyZXNob2xkRHJhd2VyKCBjaGFydCwgdCApLmRyYXcoKSApO1xyXG5cdH1cclxufVxyXG5cclxuY2xhc3MgVGhyZXNob2xkRHJhd2VyIGV4dGVuZHMgQmFzZURyYXdlcntcclxuXHRcclxuXHRjb25zdHJ1Y3RvciggY2hhcnQ6IGFueSwgcHJpdmF0ZSB0aHJlc2hvbGQ6IFRocmVzaG9sZCApe1xyXG5cdFx0c3VwZXIoIGNoYXJ0ICk7XHJcblx0fVxyXG5cclxuXHRkcmF3KCl7XHJcblx0XHRpZiggdGhpcy50aHJlc2hvbGQudmFsdWUgPT0gdW5kZWZpbmVkICl7XHJcblx0XHRcdHJldHVybjtcclxuXHRcdH1cclxuXHJcblx0XHRjb25zdCBzY2FsZVlBID0gdGhpcy5jaGFydC5zY2FsZXNbIEFYSVNfWV9MRUZUIF07XHJcblx0XHRjb25zdCBzY2FsZVlCID0gdGhpcy5jaGFydC5zY2FsZXNbIEFYSVNfWV9SSUdIVCBdO1xyXG5cdFx0Y29uc3Qgc2NhbGVYID0gdGhpcy5jaGFydC5zY2FsZXNbIEFYSVNfWCBdO1xyXG5cclxuXHRcdGNvbnN0IHNjYWxlWSA9ICggdGhpcy50aHJlc2hvbGQuYXhpcyA9PSBUaHJlc2hvbGRBeGlzLlJpZ2h0ICYmIHNjYWxlWUIgKSA/XHJcblx0XHRcdHNjYWxlWUIgOiBzY2FsZVlBO1xyXG5cclxuXHRcdGNvbnN0IG9mZnNldCA9IHNjYWxlWS5nZXRQaXhlbEZvclZhbHVlKHRoaXMudGhyZXNob2xkLnZhbHVlKTtcclxuXHJcblx0XHRjb25zdCBndCA9ICggdGhpcy50aHJlc2hvbGQub3BlcmF0b3IgPT0gVGhyZXNob2xkT3BlcmF0b3IuR3QgKTtcclxuXHJcblx0XHRjb25zdCBzaG91bGRJZ25vcmUgPSBcclxuXHRcdFx0KCAhZ3QgJiYgdGhpcy50aHJlc2hvbGQudmFsdWUgPCBzY2FsZVkubWluICkgfHxcclxuXHRcdFx0KCBndCAmJiB0aGlzLnRocmVzaG9sZC52YWx1ZSA+IHNjYWxlWS5tYXggKSB8fFxyXG5cdFx0XHQoICF0aGlzLmNoYXJ0LmRhdGEuZGF0YXNldHMubGVuZ3RoICk7XHJcblxyXG5cdFx0aWYoIHNob3VsZElnbm9yZSApe1xyXG5cdFx0XHRyZXR1cm47XHJcblx0XHR9XHJcblxyXG5cdFx0Ly8gaWYoIG9mZnNldCA8IDAgfHwgb2Zmc2V0ID4gc2NhbGVZLmJvdHRvbSApe1xyXG5cdFx0Ly8gXHRyZXR1cm47XHJcblx0XHQvLyB9XHJcblxyXG5cdFx0Ly9jb25zb2xlLmxvZyggYCR7b2Zmc2V0fSB8ICR7c2NhbGVZLmJvdHRvbX1gICkgIFxyXG5cclxuXHRcdGlmKCB0aGlzLnRocmVzaG9sZC5saW5lICl7XHJcblx0XHRcdGNvbnN0IGxpbmVDb2xvciA9IHRoaXMuZ2V0Q29sb3IoIGZhbHNlICk7XHJcblx0XHRcdHRoaXMucmVuZGVyTGluZSggc2NhbGVYLCBsaW5lQ29sb3IsIG9mZnNldCApO1xyXG5cdFx0fVxyXG5cclxuXHRcdGlmKCB0aGlzLnRocmVzaG9sZC5maWxsICl7XHJcblx0XHRcdHRoaXMucmVuZGVyUmVjdGFuZ2xlKCBzY2FsZVgsIHNjYWxlWSwgb2Zmc2V0ICk7XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHRwcml2YXRlIHJlbmRlckxpbmUoc2NhbGVYLCBjb2xvciwgb2Zmc2V0ICl7XHJcblx0XHR0aGlzLmNvbnRleHQuYmVnaW5QYXRoKCk7XHJcblx0XHR0aGlzLmNvbnRleHQuc3Ryb2tlU3R5bGUgPSBjb2xvciArIFwiOTlcIjtcclxuXHRcdHRoaXMuY29udGV4dC5saW5lV2lkdGggPSAyO1xyXG5cdFx0dGhpcy5jb250ZXh0Lm1vdmVUbyggc2NhbGVYLmxlZnQsIG9mZnNldCk7XHJcblx0XHR0aGlzLmNvbnRleHQubGluZVRvKCBzY2FsZVgucmlnaHQsIG9mZnNldCk7XHJcblx0XHR0aGlzLmNvbnRleHQuc3Ryb2tlKCk7XHJcblx0fVxyXG5cclxuXHRwcml2YXRlIHJlbmRlclJlY3RhbmdsZSggc2NhbGVYLCBzY2FsZVksIG9mZnNldCApe1xyXG5cdFx0Y29uc3QgY29sb3IgPSB0aGlzLmdldENvbG9yKCB0cnVlICk7XHJcblxyXG5cdFx0Y29uc3QgZ3QgPSAoIHRoaXMudGhyZXNob2xkLm9wZXJhdG9yID09IFRocmVzaG9sZE9wZXJhdG9yLkd0ICk7XHJcblx0XHR0aGlzLmNvbnRleHQuZmlsbFN0eWxlID0gY29sb3IgKyBcIjIyXCJcclxuXHJcblx0XHRjb25zdCB4ID0gc2NhbGVYLmxlZnQ7XHJcblx0XHRjb25zdCB3ID0gc2NhbGVYLndpZHRoO1xyXG5cclxuXHRcdGNvbnN0IHRvcFkgPSBzY2FsZVkuZ2V0UGl4ZWxGb3JWYWx1ZShzY2FsZVkubWF4KTtcclxuXHRcdGNvbnN0IGJvdHRvbVkgPSBzY2FsZVkuZ2V0UGl4ZWxGb3JWYWx1ZShzY2FsZVkubWluKTtcclxuXHJcblx0XHRjb25zdCB5ID0gZ3QgPyB0b3BZIDogTWF0aC5tYXgoIHRvcFksIG9mZnNldCApO1xyXG5cdFx0bGV0IGggPSBndCA/IG9mZnNldCAtIHNjYWxlWS50b3AgOiBzY2FsZVkuYm90dG9tIC0gb2Zmc2V0O1xyXG5cclxuXHRcdGggPSBNYXRoLm1pbiggYm90dG9tWSAtIHRvcFksIGggKVxyXG5cclxuXHRcdHRoaXMuY29udGV4dC5maWxsUmVjdCggeCwgeSxcdHcsIGggKTtcdFxyXG5cdH1cclxuXHJcblx0cHJpdmF0ZSBnZXRDb2xvcihmaWxsKXtcclxuXHRcdHN3aXRjaCggdGhpcy50aHJlc2hvbGQuY29sb3JUeXBlICl7XHJcblx0XHRcdGNhc2UgVGhyZXNob2xkQ29sb3IuQ3JpdGljYWw6XHJcblx0XHRcdFx0cmV0dXJuICcjRUQyRTE4JztcclxuXHJcblx0XHRcdGNhc2UgVGhyZXNob2xkQ29sb3IuT2s6XHJcblx0XHRcdFx0cmV0dXJuICcjMTBhMzQ1JztcclxuXHJcblx0XHRcdGNhc2UgVGhyZXNob2xkQ29sb3IuV2FybmluZzpcclxuXHRcdFx0XHRyZXR1cm4gJyNmNzk1MjAnO1xyXG5cdFx0fVxyXG5cclxuXHRcdGNvbnN0IGRlZmF1bHRDb2xvciA9ICcjZmZmZmZmJztcclxuXHJcblx0XHRpZiggZmlsbCApe1xyXG5cdFx0XHRyZXR1cm4gdGhpcy50aHJlc2hvbGQuZmlsbENvbG9yID8gdGhpcy50aHJlc2hvbGQuZmlsbENvbG9yIDogZGVmYXVsdENvbG9yO1xyXG5cdFx0fVxyXG5cclxuXHRcdHJldHVybiB0aGlzLnRocmVzaG9sZC5saW5lQ29sb3IgPyB0aGlzLnRocmVzaG9sZC5saW5lQ29sb3IgOiBkZWZhdWx0Q29sb3I7XHJcblx0fVxyXG59Il19