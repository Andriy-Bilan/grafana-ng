!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("@angular/forms"),require("uilib"),require("@angular/common"),require("common"),require("lodash"),require("rxjs"),require("rxjs/operators")):"function"==typeof define&&define.amd?define("influx",["exports","@angular/core","@angular/forms","uilib","@angular/common","common","lodash","rxjs","rxjs/operators"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).influx={},e.ng.core,e.ng.forms,e.i2,e.ng.common,e.i1$1,e._,e.rxjs,e.rxjs.operators)}(this,(function(e,t,n,r,o,i,a,l,u){"use strict";function s(e,n){1&e&&t.ɵɵtext(0," please enter url ")}function c(e,n){1&e&&t.ɵɵtemplate(0,s,1,0,"ng-template",16)}var m=function(){function e(){this.form=new n.FormGroup({url:new n.FormControl(null,n.Validators.required),whitelistedCookies:new n.FormControl(null),basicAuthentication:new n.FormControl(!1),withCredentials:new n.FormControl(!1),tlsClientAuth:new n.FormControl(!1),withCaCert:new n.FormControl(!1),skipTlsVerification:new n.FormControl(!1),database:new n.FormControl(null,n.Validators.required),user:new n.FormControl(null),password:new n.FormControl(null),minTimeInterval:new n.FormControl(null)})}return Object.defineProperty(e.prototype,"url",{get:function(){return this.form.get("url")},enumerable:!1,configurable:!0}),e}();m.ɵfac=function(e){return new(e||m)},m.ɵcmp=t.ɵɵdefineComponent({type:m,selectors:[["ds-settings-editor"]],decls:41,vars:14,consts:[[3,"formGroup"],[1,"page-heading"],[1,"gf-form-group"],["label","URL","labelWidth","10","hint","Specify a complete HTTP URL (for example http://your_server:8080)","formControlName","url"],[4,"ngIf"],["label","Whitelisted Cookies","labelWidth","10","formControlName","whitelistedCookies"],[1,"gf-form-inline"],["labelWidth","10","label","Basic Auth","formControlName","basicAuthentication"],["labelWidth","10","label","With Credentials","hint","Whether credentials such as cookies or auth headers should be sent with cross-site requests.","formControlName","withCredentials"],["labelWidth","10","label","TLS Client Auth","formControlName","tlsClientAuth"],["labelWidth","10","label","With CA Cert","hint","Needed for verifing self-signed TLS Certs","formControlName","withCaCert"],["labelWidth","10","label","Skip TLS Verify","formControlName","skipTlsVerification"],["formControlName","database",3,"label","labelWidth"],["formControlName","user",3,"label","labelWidth","width"],["type","password","formControlName","password",3,"label","labelWidth","width"],["hint","'A lower limit for the auto group by time interval. Recommended to be set to write frequency,\n\t\t\t\tfor example 1m if your data is written every minute.'","type","password","formControlName","minTimeInterval",3,"label","labelWidth","width","placeholder"],["edValidationTemplate",""]],template:function(e,n){1&e&&(t.ɵɵelementStart(0,"div",0),t.ɵɵelementStart(1,"h3",1),t.ɵɵtext(2,"HTTP"),t.ɵɵelementEnd(),t.ɵɵelementStart(3,"div",2),t.ɵɵelementStart(4,"ed-textbox",3),t.ɵɵtemplate(5,c,1,0,void 0,4),t.ɵɵelementEnd(),t.ɵɵelement(6,"ed-textbox",5),t.ɵɵelementEnd(),t.ɵɵelementStart(7,"h3",1),t.ɵɵtext(8,"Auth"),t.ɵɵelementEnd(),t.ɵɵelementStart(9,"div",2),t.ɵɵelementStart(10,"div",6),t.ɵɵelement(11,"ed-checkbox",7),t.ɵɵelement(12,"ed-checkbox",8),t.ɵɵelementEnd(),t.ɵɵelementStart(13,"div",6),t.ɵɵelement(14,"ed-checkbox",9),t.ɵɵelement(15,"ed-checkbox",10),t.ɵɵelementEnd(),t.ɵɵelementStart(16,"div",6),t.ɵɵelement(17,"ed-checkbox",11),t.ɵɵelementEnd(),t.ɵɵelementEnd(),t.ɵɵelementStart(18,"h3",1),t.ɵɵtext(19,"InfluxDB Details"),t.ɵɵelementEnd(),t.ɵɵelementStart(20,"div",2),t.ɵɵelement(21,"ed-textbox",12),t.ɵɵelementStart(22,"div",6),t.ɵɵelement(23,"ed-textbox",13),t.ɵɵelement(24,"ed-textbox",14),t.ɵɵelementEnd(),t.ɵɵelementEnd(),t.ɵɵelementStart(25,"div",2),t.ɵɵelementStart(26,"ed-info-box"),t.ɵɵelementStart(27,"h5"),t.ɵɵtext(28,"Database Access"),t.ɵɵelementEnd(),t.ɵɵelementStart(29,"p"),t.ɵɵtext(30," Setting the database for this datasource does not deny access to other databases. The InfluxDB query syntax allows switching the database in the query. For example: "),t.ɵɵelementStart(31,"code"),t.ɵɵtext(32,"SHOW MEASUREMENTS ON _internal"),t.ɵɵelementEnd(),t.ɵɵtext(33," or "),t.ɵɵelementStart(34,"code"),t.ɵɵtext(35,'SELECT * FROM "_internal".."database" LIMIT 10'),t.ɵɵelementEnd(),t.ɵɵelement(36,"br"),t.ɵɵelement(37,"br"),t.ɵɵtext(38," To support data isolation and security, make sure appropriate permissions are configured in InfluxDB. "),t.ɵɵelementEnd(),t.ɵɵelementEnd(),t.ɵɵelementEnd(),t.ɵɵelementStart(39,"div",2),t.ɵɵelement(40,"ed-textbox",15),t.ɵɵelementEnd(),t.ɵɵelementEnd()),2&e&&(t.ɵɵproperty("formGroup",n.form),t.ɵɵadvance(5),t.ɵɵproperty("ngIf",n.url.hasError("required")&&n.url.touched),t.ɵɵadvance(16),t.ɵɵproperty("label","Database")("labelWidth",10),t.ɵɵadvance(2),t.ɵɵproperty("label","User")("labelWidth",10)("width",5),t.ɵɵadvance(1),t.ɵɵproperty("label","Password")("labelWidth",10)("width",5),t.ɵɵadvance(16),t.ɵɵproperty("label","Min time interval")("labelWidth",11)("width",5)("placeholder","10s"))},directives:[n.NgControlStatusGroup,n.FormGroupDirective,r.TextBoxComponent,n.NgControlStatus,n.FormControlName,o.NgIf,r.CheckBoxComponent,r.InfoBoxComponent,r.TextBoxValidationTemplate],encapsulation:2});var d,f,p=function(){this.measurement="",this.policy="",this.refId="",this.tags=new Array,this.fields=new Array,this.limit=void 0,this.slimit=void 0};(d=e.AggrFunc||(e.AggrFunc={})).Count="count",d.Distinct="distinct",d.Integral="integral",d.Mean="mean",d.Median="median",d.Mode="mode",d.Sum="sum",d.Bottom="bottom",d.First="first",d.Last="last",d.Max="max",d.Min="min",d.Percentile="percentile",d.Top="top",d.Derivative="derivative",d.Spread="spread",d.NonNegativeDerivative="non_negative_derivative",d.Difference="difference",d.NonNegativeDifference="non_negative_difference",d.MovingAverage="moving_average",d.CumulativeSum="cumulative_sum",d.Stddev="stddev",d.Elapsed="elapsed",d.HoltWinters="holt_winters",d.HoltWintersWithFit="holt_winters_with_fit",d.Math="math",d.Alias="alias",(f=e.AggrFuncGroup||(e.AggrFuncGroup={}))[f.Aggregations=0]="Aggregations",f[f.Selectors=1]="Selectors",f[f.Transformations=2]="Transformations",f[f.Predictors=3]="Predictors",f[f.Math=4]="Math",f[f.Alias=5]="Alias";var g,v,h,y,x=function(){function t(){}return t.getGroup=function(t){switch(t){case e.AggrFunc.Count:case e.AggrFunc.Distinct:case e.AggrFunc.Integral:case e.AggrFunc.Mean:case e.AggrFunc.Median:case e.AggrFunc.Mode:case e.AggrFunc.Sum:return e.AggrFuncGroup.Aggregations;case e.AggrFunc.Bottom:case e.AggrFunc.First:case e.AggrFunc.Last:case e.AggrFunc.Max:case e.AggrFunc.Min:case e.AggrFunc.Percentile:case e.AggrFunc.Top:return e.AggrFuncGroup.Selectors;case e.AggrFunc.Derivative:case e.AggrFunc.Spread:case e.AggrFunc.NonNegativeDerivative:case e.AggrFunc.Difference:case e.AggrFunc.NonNegativeDifference:case e.AggrFunc.MovingAverage:case e.AggrFunc.CumulativeSum:case e.AggrFunc.Stddev:case e.AggrFunc.Elapsed:return e.AggrFuncGroup.Transformations;case e.AggrFunc.HoltWinters:case e.AggrFunc.HoltWintersWithFit:return e.AggrFuncGroup.Predictors;case e.AggrFunc.Math:return e.AggrFuncGroup.Math;case e.AggrFunc.Alias:return e.AggrFuncGroup.Alias}},t}();(g=e.GroupByOption||(e.GroupByOption={}))[g.Time=0]="Time",g[g.Fill=1]="Fill",g[g.Tag=2]="Tag",(v=e.GroupByTimeOptions||(e.GroupByTimeOptions={})).Dynamic="$__interval",v.S1="1s",v.S10="10s",v.M1="1m",v.M5="5m",v.M10="10m",v.M15="15m",v.H1="1h",(h=e.GroupByFillOptions||(e.GroupByFillOptions={})).None="none",h.Null="null",h.Zero="0",h.Prev="previous",h.Linear="linear",(y=e.OrderByTime||(e.OrderByTime={}))[y.Asc=0]="Asc",y[y.Desc=1]="Desc";var b=function(){};b.TIME_FILTER="$timeFilter",b.TIME_INTERVAL="$__interval";var w,C,E=function(){this.key="",this.value="",this.index=0,this.operator=e.TagOperator.Eq,this.condition=e.TagCondition.And};(w=e.TagOperator||(e.TagOperator={})).Eq="=",w.Neq="<>",w.Less="<",w.Greater=">",w.RegExEq="=~",w.RegExNeq="!~",(C=e.TagCondition||(e.TagCondition={})).And="AND",C.Or="OR";var S=function(){function e(e){this.time=e}return e.prototype.build=function(e,t){var n=this,r=[];e.targets.forEach((function(e){var o=new M(n.time,e,t);o.invalid||e.virgin||r.push(o.text)}));var o=r.join(";");return l.of(o)},e}();S.ɵfac=function(e){return new(e||S)(t.ɵɵdirectiveInject(i.TimeRangeStore))},S.ɵcmp=t.ɵɵdefineComponent({type:S,selectors:[["metrics-builder"]],decls:0,vars:0,template:function(e,t){},encapsulation:2});var M=function(){function t(e,t,n){this.time=e,this.target=t,this.range=n}return Object.defineProperty(t.prototype,"invalid",{get:function(){return!this.target||!this.target.fields||0===this.target.fields.length},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"text",{get:function(){return"SELECT "+this.getFieldsText()+" FROM "+this.getMeasurementText()},enumerable:!1,configurable:!0}),t.prototype.getFieldsText=function(){var e=this,t="";return this.target.fields?(this.target.fields.forEach((function(n){t.length>0&&(t+=", "),t+=e.getFieldText(n)})),t):t},t.prototype.getFieldText=function(t){var n="",r=t.key?t.key:"field",o=t.functions.find((function(t){return x.getGroup(t.name)==e.AggrFuncGroup.Aggregations||x.getGroup(t.name)==e.AggrFuncGroup.Selectors}));o?n+=o.name+(o.param&&o.param.value?'("'+r+'", '+o.param.value+")":'("'+r+'")'):n='"'+r+'"',t.functions.filter((function(t){return x.getGroup(t.name)===e.AggrFuncGroup.Transformations})).forEach((function(e){var t=e.param&&e.param.value?", "+e.param.value:"";n=e.name+"("+n+t+")"}));var i=t.functions.find((function(t){return x.getGroup(t.name)===e.AggrFuncGroup.Math}));i&&(n=n+" "+i.param.value);var a=t.functions.find((function(t){return x.getGroup(t.name)===e.AggrFuncGroup.Alias}));return a&&(n=n+' AS "'+a.param.value+'"'),n},t.prototype.getMeasurementText=function(){var t=this.target.measurement?this.target.measurement:"measurement",n=(this.target.policy&&this.target.policy.length>0&&"default"!==this.target.policy?'"'+this.target.policy+'".':"")+'"'+t+'"',r="",o=0;this.target.tags&&this.target.tags.filter((function(e){return e.key&&e.value})).forEach((function(e){o>0&&(r+=" "+e.condition+" "),r+=' "'+e.key+'" '+e.operator+" '"+e.value+"'",++o}));var i=this.range?this.getTimeFilter():b.TIME_FILTER;n=r.length>0?n+" WHERE ("+r+") and "+i:n+" WHERE "+i;var a=this.target.groupBy,l=a.find((function(t){return t.type==e.GroupByOption.Time})),u=a.find((function(t){return t.type==e.GroupByOption.Fill})),s=a.filter((function(t){return t.type==e.GroupByOption.Tag}));if(l){var c=this.range?this.getOptimalAutoGroupBy():l.params[0];n=n+" GROUP BY time("+c+")"}return s.length>0&&(n=l?n+",":n+" GROUP BY",s.forEach((function(e,t){n=n+(t>0?", ":" ")+' "'+e.params[0]+'"'}))),u&&(n=n+" FILL("+u.params[0]+")"),this.target.order!=e.OrderByTime.Asc&&(n+=" ORDER BY time DESC"),this.target.limit>0&&(n=n+" LIMIT "+this.target.limit),this.target.slimit>0&&(n=n+" SLIMIT "+this.target.slimit),n},t.prototype.getOptimalAutoGroupBy=function(){var e=i.TimeRangeParser.toDateTime(this.range.from,!1),t=i.TimeRangeParser.toDateTime(this.range.to,!0);return 5>+t.diff(e,"minutes")?"200ms":15>+t.diff(e,"minutes")?"1s":30>t.diff(e,"minutes")?"2s":1>t.diff(e,"hours")?"5s":3>t.diff(e,"hours")?"10s":6>t.diff(e,"hours")?"20s":12>t.diff(e,"hours")?"1m":24>t.diff(e,"hours")?"2m":7>t.diff(e,"days")?"10m":31>t.diff(e,"days")?"1h":365>t.diff(e,"days")?"12h":"24h"},t.prototype.getTimeFilter=function(){var e=this.range,t=this.time.converter.timezone,n=this.getInfluxTime(e.from,!1,t),r=this.getInfluxTime(e.to,!0,t),o="ms"===n[n.length-1];return"now()"!==r||o?"time >= "+n+" and time <= "+r:"time >= "+n},t.prototype.getInfluxTime=function(e,t,n){if(a.isString(e)){if("now"===e)return"now()";var r=/^now-(\d+)([dhms])$/.exec(e);if(r)return"now() - "+parseInt(r[1],10)+r[2];e=i.TimeRangeParser.toDateTime(e,t,n)}return e.valueOf()+"ms"},t}(),F=function(e,t){return(F=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */function T(e,t){function n(){this.constructor=e}F(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}function A(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a}function q(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(A(arguments[t]));return e}var I=function(){};I.ɵfac=function(e){return new(e||I)},I.ɵdir=t.ɵɵdefineDirective({type:I,inputs:{query:"query"}});var O=function(){return{color:"#eb7b18"}};function D(e,n){if(1&e){var r=t.ɵɵgetCurrentView();t.ɵɵelementStart(0,"ed-autocomplete-picker",13),t.ɵɵlistener("ngModelChange",(function(e){return t.ɵɵrestoreView(r),t.ɵɵnextContext().$implicit.operator=e})),t.ɵɵelementEnd()}if(2&e){var o=t.ɵɵnextContext().$implicit,i=t.ɵɵnextContext();t.ɵɵproperty("ngModel",o.operator)("valueStyle",t.ɵɵpureFunction0(3,O))("request",i.tagOperatorsRequest(o))}}function k(e,n){if(1&e){var r=t.ɵɵgetCurrentView();t.ɵɵelementStart(0,"ed-autocomplete-picker",14),t.ɵɵlistener("ngModelChange",(function(e){return t.ɵɵrestoreView(r),t.ɵɵnextContext().$implicit.value=e})),t.ɵɵelementEnd()}if(2&e){var o=t.ɵɵnextContext().$implicit,i=t.ɵɵnextContext();t.ɵɵproperty("placeholder","select tag value")("ngModel",o.value)("request",i.showTagValuesRequest(o))}}var N=function(){return{color:"#33b5e5 "}};function R(e,n){if(1&e){var r=t.ɵɵgetCurrentView();t.ɵɵelementContainerStart(0),t.ɵɵelementStart(1,"ed-autocomplete-picker",9),t.ɵɵlistener("ngModelChange",(function(e){return t.ɵɵrestoreView(r),n.$implicit.condition=e})),t.ɵɵelementEnd(),t.ɵɵelementStart(2,"ed-autocomplete-picker",10),t.ɵɵlistener("ngModelChange",(function(e){return t.ɵɵrestoreView(r),n.$implicit.key=e})),t.ɵɵelementEnd(),t.ɵɵtemplate(3,D,1,4,"ed-autocomplete-picker",11),t.ɵɵtemplate(4,k,1,3,"ed-autocomplete-picker",12),t.ɵɵelementContainerEnd()}if(2&e){var o=n.$implicit,i=n.index,a=t.ɵɵnextContext();t.ɵɵadvance(1),t.ɵɵproperty("hidden",!(i>0&&o.key))("ngModel",o.condition)("valueStyle",t.ɵɵpureFunction0(8,N))("request",a.andOrRequest()),t.ɵɵadvance(1),t.ɵɵproperty("ngModel",o.key)("request",a.showTagKeysRequest()),t.ɵɵadvance(1),t.ɵɵproperty("ngIf",o.key),t.ɵɵadvance(1),t.ɵɵproperty("ngIf",o.key)}}var G=function(t){function n(e){var n=t.call(this)||this;return n.dsService=e,n.DEFAULT_POLICY="default",n}return T(n,t),n.prototype.ngOnInit=function(){var e;(null===(e=this.query.tags)||void 0===e?void 0:e.length)||this.query.tags.push(new E),this.query.policy||(this.query.policy=this.DEFAULT_POLICY)},n.prototype.showRetentionPolicies=function(){return this.dsService.proxy(1,"SHOW RETENTION POLICIES").pipe(u.map((function(e){return q(["default"],e[0].values.map((function(e){return e[0]})))})))},n.prototype.showMeasurementsRequest=function(){return this.dsService.proxy(1,"SHOW MEASUREMENTS").pipe(u.map((function(e){return q(e[0].values).reduce((function(e,t){return e.concat(t)}),[])})))},n.prototype.tagOperatorsRequest=function(t){var n=this.isRegex(t.value),r=Object.values(e.TagOperator),o=n?r.slice(4,6):r.slice(0,4);return l.of(o)},n.prototype.showTagValuesRequest=function(e){var t="SHOW TAG VALUES  WITH KEY="+e.key;return this.dsService.proxy(1,t).pipe(u.map((function(e){return e[0].values.map((function(e){return e[1]}))})))},n.prototype.showTagKeysRequest=function(){var e=this.query.measurement?"SHOW TAG KEYS from "+this.query.measurement:"SHOW TAG KEYS";return this.dsService.proxy(1,e).pipe(u.map((function(e){return q(e[0].values.reduce((function(e,t){return e.concat(t)}),[]),["--remove--"])})))},n.prototype.isRegex=function(e){var t=!0;try{new RegExp(e),t=e.startsWith("/")&&e.endsWith("/")}catch(e){t=!1}return t},n.prototype.andOrRequest=function(){return l.of(Object.values(e.TagCondition))},n}(I);function W(e,n){1&e&&t.ɵɵelement(0,"i",20)}function _(e,n){1&e&&t.ɵɵelement(0,"i",21)}function B(e,n){if(1&e){var r=t.ɵɵgetCurrentView();t.ɵɵelementStart(0,"div",22),t.ɵɵelementStart(1,"div",23),t.ɵɵelementStart(2,"label",24),t.ɵɵlistener("click",(function(){t.ɵɵrestoreView(r);var e=t.ɵɵnextContext();return e.opened=!e.opened})),t.ɵɵtext(3," query content will be here "),t.ɵɵelementEnd(),t.ɵɵelementEnd(),t.ɵɵelementEnd()}}function P(e,n){if(1&e&&(t.ɵɵelementStart(0,"div",25),t.ɵɵelement(1,"measurement-editor",26),t.ɵɵelementEnd()),2&e){var r=t.ɵɵnextContext();t.ɵɵadvance(1),t.ɵɵproperty("query",r.query)}}G.ɵfac=function(e){return new(e||G)(t.ɵɵdirectiveInject(i.DataSourceService))},G.ɵcmp=t.ɵɵdefineComponent({type:G,selectors:[["measurement-editor"]],features:[t.ɵɵInheritDefinitionFeature],decls:11,vars:5,consts:[[1,"gf-form-inline"],[1,"gf-form","gf-form-label","query-keyword","width-7"],[3,"ngModel","request","ngModelChange"],["placeholder","select measurement",3,"ngModel","request","ngModelChange"],[1,"gf-form"],[1,"gf-form-label","query-keyword"],[4,"ngFor","ngForOf"],[1,"gf-form","gf-form--grow"],[1,"gf-form-label","gf-form-label--grow"],[3,"hidden","ngModel","valueStyle","request","ngModelChange"],["placeholder","fa fa-plus",3,"ngModel","request","ngModelChange"],[3,"ngModel","valueStyle","request","ngModelChange",4,"ngIf"],[3,"placeholder","ngModel","request","ngModelChange",4,"ngIf"],[3,"ngModel","valueStyle","request","ngModelChange"],[3,"placeholder","ngModel","request","ngModelChange"]],template:function(e,n){1&e&&(t.ɵɵelementStart(0,"div",0),t.ɵɵelementStart(1,"label",1),t.ɵɵtext(2,"FROM"),t.ɵɵelementEnd(),t.ɵɵelementStart(3,"ed-autocomplete-picker",2),t.ɵɵlistener("ngModelChange",(function(e){return n.query.policy=e})),t.ɵɵelementEnd(),t.ɵɵelementStart(4,"ed-autocomplete-picker",3),t.ɵɵlistener("ngModelChange",(function(e){return n.query.measurement=e})),t.ɵɵelementEnd(),t.ɵɵelementStart(5,"div",4),t.ɵɵelementStart(6,"label",5),t.ɵɵtext(7,"WHERE"),t.ɵɵelementEnd(),t.ɵɵelementEnd(),t.ɵɵtemplate(8,R,5,9,"ng-container",6),t.ɵɵelementStart(9,"div",7),t.ɵɵelement(10,"div",8),t.ɵɵelementEnd(),t.ɵɵelementEnd()),2&e&&(t.ɵɵadvance(3),t.ɵɵproperty("ngModel",n.query.policy)("request",n.showRetentionPolicies()),t.ɵɵadvance(1),t.ɵɵproperty("ngModel",n.query.measurement)("request",n.showMeasurementsRequest()),t.ɵɵadvance(4),t.ɵɵproperty("ngForOf",n.query.tags))},directives:[r.AutoCompletePickerComponent,n.NgControlStatus,n.NgModel,o.NgForOf,o.NgIf],encapsulation:2});var V=function(e){function n(){var n=e.call(this)||this;return n.contextMenuItems=[],n.opened=!0,n.editMode=!1,n.remove=new t.EventEmitter,n.moveUp=new t.EventEmitter,n.moveDown=new t.EventEmitter,n.duplicate=new t.EventEmitter,n}return T(n,e),n.prototype.ngOnInit=function(){var e=this;this.contextMenuItems=[{label:"Toggle edit mode",command:function(t){return e.editMode!=e.editMode}},{label:"Duplicate",command:function(t){return e.duplicate.emit()}},{label:"Move up",command:function(t){return e.moveUp.emit()}},{label:"Move down",command:function(t){return e.moveDown.emit()}}]},n}(I);function L(e,n){if(1&e){var r=t.ɵɵgetCurrentView();t.ɵɵelementStart(0,"query-editor",1),t.ɵɵlistener("remove",(function(){t.ɵɵrestoreView(r);var e=n.$implicit;return t.ɵɵnextContext().onRemove(e)}))("duplicate",(function(){t.ɵɵrestoreView(r);var e=n.$implicit;return t.ɵɵnextContext().onDuplicate(e)}))("moveUp",(function(){t.ɵɵrestoreView(r);var e=n.$implicit;return t.ɵɵnextContext().onMoveUp(e)}))("moveDown",(function(){t.ɵɵrestoreView(r);var e=n.$implicit;return t.ɵɵnextContext().onMoveDown(e)})),t.ɵɵelementEnd()}if(2&e){var o=n.$implicit;t.ɵɵproperty("query",o)}}V.ɵfac=function(e){return new(e||V)},V.ɵcmp=t.ɵɵdefineComponent({type:V,selectors:[["query-editor"]],outputs:{remove:"remove",moveUp:"moveUp",moveDown:"moveDown",duplicate:"duplicate"},features:[t.ɵɵInheritDefinitionFeature],decls:23,vars:6,consts:[[1,"gf-form-query"],[1,"gf-form","gf-form-query-letter-cell",3,"click"],[1,"gf-form-label"],["tabindex","1",1,"pointer"],["ng-class","{muted: !ctrl.canCollapse}",1,"gf-form-query-letter-cell-carret"],["class","fa fa-caret-down",4,"ngIf"],["class","fa fa-caret-right",4,"ngIf"],[1,"gf-form-query-letter-cell-letter"],["class","gf-form-query-content gf-form-query-content--collapsed mr-1",4,"ngIf"],["ng-transclude","","class","gf-form-query-content",4,"ngIf"],[1,"gf-form","ed"],[1,"gf-form-label",3,"click"],["data-toggle","dropdown","tabindex","1",1,"pointer","dropdown-toggle"],[1,"fa","fa-bars"],["ng-click","ctrl.toggleHideQuery()","role","menuitem"],[1,"fa","fa-eye"],["tabindex","1",1,"pointer",3,"click"],[1,"fa","fa-trash"],[3,"items"],["cm",""],[1,"fa","fa-caret-down"],[1,"fa","fa-caret-right"],[1,"gf-form-query-content","gf-form-query-content--collapsed","mr-1"],[1,"gf-form"],[1,"gf-form-label","pointer","gf-form-label--grow",3,"click"],["ng-transclude","",1,"gf-form-query-content"],[3,"query"]],template:function(e,n){if(1&e){var r=t.ɵɵgetCurrentView();t.ɵɵelementStart(0,"div",0),t.ɵɵelementStart(1,"div",1),t.ɵɵlistener("click",(function(){return n.opened=!n.opened})),t.ɵɵelementStart(2,"label",2),t.ɵɵelementStart(3,"a",3),t.ɵɵelementStart(4,"span",4),t.ɵɵtemplate(5,W,1,0,"i",5),t.ɵɵtemplate(6,_,1,0,"i",6),t.ɵɵelementEnd(),t.ɵɵelementStart(7,"span",7),t.ɵɵtext(8),t.ɵɵelementEnd(),t.ɵɵelementEnd(),t.ɵɵelementEnd(),t.ɵɵelementEnd(),t.ɵɵtemplate(9,B,4,0,"div",8),t.ɵɵtemplate(10,P,2,1,"div",9),t.ɵɵelementStart(11,"div",10),t.ɵɵelementStart(12,"label",11),t.ɵɵlistener("click",(function(e){return t.ɵɵrestoreView(r),t.ɵɵreference(22).show(e)})),t.ɵɵelementStart(13,"a",12),t.ɵɵelement(14,"i",13),t.ɵɵelementEnd(),t.ɵɵelementEnd(),t.ɵɵelementStart(15,"label",2),t.ɵɵelementStart(16,"a",14),t.ɵɵelement(17,"i",15),t.ɵɵelementEnd(),t.ɵɵelementEnd(),t.ɵɵelementStart(18,"label",2),t.ɵɵelementStart(19,"a",16),t.ɵɵlistener("click",(function(){return n.remove.emit()})),t.ɵɵelement(20,"i",17),t.ɵɵelementEnd(),t.ɵɵelementEnd(),t.ɵɵelementEnd(),t.ɵɵelementEnd(),t.ɵɵelement(21,"ed-context-menu",18,19)}2&e&&(t.ɵɵadvance(5),t.ɵɵproperty("ngIf",n.opened),t.ɵɵadvance(1),t.ɵɵproperty("ngIf",!n.opened),t.ɵɵadvance(2),t.ɵɵtextInterpolate(n.query.refId),t.ɵɵadvance(1),t.ɵɵproperty("ngIf",!n.opened),t.ɵɵadvance(1),t.ɵɵproperty("ngIf",n.opened),t.ɵɵadvance(11),t.ɵɵproperty("items",n.contextMenuItems))},directives:[o.NgIf,r.ContextMenuComponent,G],encapsulation:2});var j=function(){function e(e){this.panel=e}return Object.defineProperty(e.prototype,"metrics",{get:function(){return this.panel.widget.metrics},enumerable:!1,configurable:!0}),e.prototype.onRemove=function(e){var t=this.metrics.targets.indexOf(e);-1!==t&&this.metrics.targets.splice(t,1)},e.prototype.onMoveUp=function(e){console.log("onMoveUp")},e.prototype.onMoveDown=function(e){console.log("onMoveDown")},e.prototype.onDuplicate=function(e){console.log("duplicate")},e}();j.ɵfac=function(e){return new(e||j)(t.ɵɵdirectiveInject(i.PANEL_TOKEN))},j.ɵcmp=t.ɵɵdefineComponent({type:j,selectors:[["metrics-designer"]],decls:1,vars:1,consts:[[3,"query","remove","duplicate","moveUp","moveDown",4,"ngFor","ngForOf"],[3,"query","remove","duplicate","moveUp","moveDown"]],template:function(e,n){1&e&&t.ɵɵtemplate(0,L,1,1,"query-editor",0),2&e&&t.ɵɵproperty("ngForOf",n.metrics.targets)},directives:[o.NgForOf,V],encapsulation:2});var U=function(){};U.ɵmod=t.ɵɵdefineNgModule({type:U}),U.ɵinj=t.ɵɵdefineInjector({factory:function(e){return new(e||U)},imports:[[o.CommonModule,n.FormsModule,n.ReactiveFormsModule,i.EdCommonModule,r.EdUilibModule]]}),("undefined"==typeof ngJitMode||ngJitMode)&&t.ɵɵsetNgModuleScope(U,{declarations:[m,S,j,V,G],imports:[o.CommonModule,n.FormsModule,n.ReactiveFormsModule,i.EdCommonModule,r.EdUilibModule],exports:[m,S,j]}),e.AggrFuncHelper=x,e.InfluxMetricsBuilder=S,e.InfluxMetricsDesignerComponent=j,e.InfluxModule=U,e.InfluxQuery=p,e.InfluxSettingsEditorComponent=m,e.MetricVars=b,e.Tag=E,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=influx.umd.min.js.map